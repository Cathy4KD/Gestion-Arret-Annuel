<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion Arr√™t Annuel 2026 - Application Refactoris√©e</title>

    <!-- CDN Libraries - Charg√©es en defer (non-bloquant, ordre pr√©serv√©) -->
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- jsPDF Library (pour export PDF) -->
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- PDF.js Library (pour conversion PDF vers image) -->
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script defer>
        // Configuration de PDF.js (apr√®s chargement)
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof pdfjsLib !== 'undefined') {
                pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
            }
        });
    </script>

    <!-- Socket.io Client (pour synchronisation temps r√©el) -->
    <script defer src="/socket.io/socket.io.js"></script>

    <!-- Custom Stylesheet Modulaire -->
    <link rel="stylesheet" href="css/main.css?v=20251103-002">

    <!-- Compact Mode - Style Excel -->
    <link rel="stylesheet" href="css/compact-mode.css?v=20251103-002">

    <style>
        /* Loader pendant l'initialisation */
        #app-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #ecf0f3;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        #app-loader.hidden {
            opacity: 0;
            pointer-events: none;
        }
        .loader-spinner {
            width: 60px;
            height: 60px;
            border: 6px solid #ecf0f3;
            border-top: 6px solid #4a7c59;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            box-shadow: 0 0 20px rgba(74, 124, 89, 0.3);
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .loader-text {
            margin-top: 20px;
            font-size: 16px;
            color: #4a7c59;
            font-weight: 600;
        }
        .loader-step {
            margin-top: 10px;
            font-size: 14px;
            color: #6b8e7d;
            font-weight: 500;
            min-height: 20px;
        }
        .loader-percentage {
            margin-top: 15px;
            font-size: 32px;
            color: #4a7c59;
            font-weight: 700;
        }
        #app-container {
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        #app-container.visible {
            opacity: 1;
        }

        /* Animations pour les notifications temps r√©el */
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Loader de d√©marrage -->
    <div id="app-loader">
        <div class="loader-spinner"></div>
        <div class="loader-text">Chargement de l'application...</div>
        <div class="loader-step" id="loader-step"></div>
        <div class="loader-percentage" id="loader-percentage">0%</div>
    </div>

    <!-- Container principal de l'application -->
    <div id="app-container">
        <div class="container">
            <div class="header">
                <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                    <div style="flex: 1; text-align: left;">
                        <button onclick="window.switchToPage('iw37n')" style="padding: 10px 20px; background: #ffffff; color: #000000; border: none; border-radius: 12px; cursor: pointer; font-weight: 700; font-size: 0.9em; margin-right: 10px; box-shadow: 3px 3px 8px rgba(163, 177, 198, 0.4), -3px -3px 8px rgba(255, 255, 255, 0.9); transition: all 0.3s ease;">
                            üìä IW37N
                        </button>
                        <button onclick="window.switchToPage('iw38')" style="padding: 10px 20px; background: #ffffff; color: #000000; border: none; border-radius: 12px; cursor: pointer; font-weight: 700; font-size: 0.9em; margin-right: 10px; box-shadow: 3px 3px 8px rgba(163, 177, 198, 0.4), -3px -3px 8px rgba(255, 255, 255, 0.9); transition: all 0.3s ease;">
                            üìä IW38
                        </button>
                        <button onclick="window.switchToPage('pieces')" style="padding: 10px 20px; background: #ffffff; color: #000000; border: none; border-radius: 12px; cursor: pointer; font-weight: 700; font-size: 0.9em; margin-right: 10px; box-shadow: 3px 3px 8px rgba(163, 177, 198, 0.4), -3px -3px 8px rgba(255, 255, 255, 0.9); transition: all 0.3s ease;">
                            üîß PIECES
                        </button>
                        <button onclick="window.switchToPage('avis')" style="padding: 10px 20px; background: #ffffff; color: #000000; border: none; border-radius: 12px; cursor: pointer; font-weight: 700; font-size: 0.9em; margin-right: 10px; box-shadow: 3px 3px 8px rgba(163, 177, 198, 0.4), -3px -3px 8px rgba(255, 255, 255, 0.9); transition: all 0.3s ease;">
                            üìù AVIS
                        </button>
                        <button onclick="window.open('https://prospect.riotinto.org/irj/servlet/prt/portal/prtroot/pcd!3aportal_content!2frt!2fent!2fgen!2fivu!2fStandard_Transaction?sap-config-mode=true', '_blank')" style="padding: 10px 20px; background: #ffffff; color: #000000; border: none; border-radius: 12px; cursor: pointer; font-weight: 700; font-size: 0.9em; box-shadow: 3px 3px 8px rgba(163, 177, 198, 0.4), -3px -3px 8px rgba(255, 255, 255, 0.9); transition: all 0.3s ease;">
                            üîó SAP
                        </button>
                    </div>
                    <div style="flex: 1; text-align: center;">
                        <h1>üè≠ ARR√äT ANNUEL 2026</h1>
                        <div class="subtitle" id="arretSubtitle">Du 1er avril au 15 avril 2026 (14 jours)</div>
                    </div>
                    <div style="flex: 1; text-align: right;">
                        <button onclick="window.switchToPage('contacts')" style="padding: 10px 20px; background: #ffffff; color: #000000; border: none; border-radius: 12px; cursor: pointer; font-weight: 700; font-size: 0.9em; margin-right: 10px; box-shadow: 3px 3px 8px rgba(163, 177, 198, 0.4), -3px -3px 8px rgba(255, 255, 255, 0.9); transition: all 0.3s ease;">
                             Contacts
                        </button>
                        <button onclick="window.switchToPage('parametres')" style="padding: 10px 20px; background: #ffffff; color: #000000; border: none; border-radius: 12px; cursor: pointer; font-weight: 700; font-size: 0.9em; box-shadow: 3px 3px 8px rgba(163, 177, 198, 0.4), -3px -3px 8px rgba(255, 255, 255, 0.9); transition: all 0.3s ease;">
                             Param√®tres
                        </button>
                    </div>
                </div>
            </div>

            <!-- Navigation par onglets -->
            <div class="nav-tabs">
                <div class="nav-tab active" onclick="window.switchToPage('dashboard')">üìä Dashboard</div>
                <div class="nav-tab" onclick="window.switchToPage('timeline')">üìÖ Timeline Kanban</div>
                <div class="nav-tab" onclick="window.switchToPage('summary')">‚ÑπÔ∏è Pr√©paration</div>
                <div class="nav-tab" onclick="window.switchToPage('execution')">‚öôÔ∏è Ex√©cution</div>
                <div class="nav-tab" onclick="window.switchToPage('post_mortem')">üìù Post-Mortem</div>
                <div class="nav-tab" onclick="window.switchToPage('historique')">üóÇÔ∏è Archives</div>
            </div>

            <!-- Conteneur pour les pages - sera charg√© dynamiquement -->
            <div id="pages-container">
                <!-- Les pages sont charg√©es dynamiquement depuis /components/pages/ -->
                <!-- Dashboard charg√© par d√©faut au d√©marrage -->
            </div>
        </div>
    </div>

    <!-- Script pour sauvegarder et restaurer les tailles des textarea -->
    <script src="./js/textarea-resize-manager.js"></script>

    <script type="module">
        // Import du point d'entr√©e principal de l'application
        import { initApp, switchPage, changeTheme } from './js/app.js?v=20251106-002';

        // Exposer les fonctions globalement pour les onclick dans le HTML
        window.switchPage = switchPage;
        window.changeTheme = changeTheme;

        window.appActions = {
            switchPage,
            changeTheme,
            initApp
        };

        // Initialisation au chargement de la page
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                console.log('[START] D√©marrage de l\'application refactoris√©e...');

                // Initialiser l'application
                await initApp();

                // Cacher le loader et afficher l'app
                setTimeout(() => {
                    document.getElementById('app-loader').classList.add('hidden');
                    document.getElementById('app-container').classList.add('visible');
                    console.log('[OK] Application d√©marr√©e avec succ√®s !');
                }, 200);

            } catch (error) {
                console.error('[ERROR] Erreur lors de l\'initialisation:', error);

                // Afficher l'erreur √† l'utilisateur
                const loaderText = document.querySelector('.loader-text');
                loaderText.textContent = '‚ùå Erreur de chargement - V√©rifiez la console';
                loaderText.style.color = '#c5554a';

                // Afficher quand m√™me l'app apr√®s 1 seconde
                setTimeout(() => {
                    document.getElementById('app-loader').classList.add('hidden');
                    document.getElementById('app-container').classList.add('visible');
                }, 1000);
            }
        });

        // Gestion des raccourcis clavier
        document.addEventListener('keydown', (e) => {
            // Ctrl + S : Sauvegarder
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                if (window.appActions && window.appActions.saveAllData) {
                    window.appActions.saveAllData();
                    console.log('[SAVE] Sauvegarde manuelle effectu√©e');
                }
            }

            // Ctrl + E : Exporter
            if (e.ctrlKey && e.key === 'e') {
                e.preventDefault();
                if (window.appActions && window.appActions.exportAllData) {
                    window.appActions.exportAllData();
                    console.log(' Export d√©clench√©');
                }
            }
        });

        // Log de la version
        console.log('%c[FACTORY] Gestion Arr√™t Annuel 2026 %c v2.0.0 - Architecture Modulaire',
                    'background: #4a7c59; color: white; padding: 5px 10px; border-radius: 3px;',
                    'background: #ecf0f3; color: #000; padding: 5px 10px;');
    </script>

    <!-- Note de d√©veloppement -->
    <!--
    ====================================
    APPLICATION REFACTORIS√âE v2.0.0
    ====================================

    Cette version utilise une architecture modulaire avec :
    - 55+ modules ES6
    - 548 fonctions extraites
    - CSS organis√© en 12 fichiers
    - Socket.io pour synchronisation temps r√©el

    Structure des modules :
    - /js/modules/navigation.js
    - /js/modules/theme.js
    - /js/modules/utils.js
    - /js/modules/init.js
    - /js/modules/data/
    - /js/modules/ui/
    - /js/modules/charts/
    - /js/modules/import-export/
    - /js/modules/forms/
    - /js/modules/modals/
    - /js/modules/tables/
    - /js/modules/plans/
    - /js/modules/demandes/
    - /js/modules/entities/
    - /js/app.js (point d'entr√©e principal)

    Pour plus de d√©tails, voir :
    - /js/modules/README-MODULES.md
    - /client/RAPPORT-EXTRACTION.md
    -->

    <!-- Modal de s√©lection des responsables -->
    <div id="responsibleModal" class="modal-overlay" onclick="window.closeModalOnOverlay(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <h3>üë• S√©lectionner les Responsables</h3>
                <button class="modal-close" onclick="window.closeResponsibleModal()">√ó</button>
            </div>
            <div class="checkbox-list" id="responsibleCheckboxList"></div>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-secondary" onclick="window.closeResponsibleModal()">Annuler</button>
                <button class="modal-btn modal-btn-primary" onclick="window.saveResponsibles()">Enregistrer</button>
            </div>
        </div>
    </div>



        <!-- ============================================ -->
        <!-- PAGES SUPPL√âMENTAIRES AJOUT√âES AUTOMATIQUEMENT -->
        <!-- 40 pages extraites du vieux HTML -->
        <!-- ============================================ -->

<div id="detail-t22" class="page">
            <div class="summary-container" style="max-width: 98%; padding: 20px;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">PROJET(S) INGQ A INCLURES DANS CALENDRIER</h2>
                </div>

                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h3 style="margin: 0; color: #2d3748;">üìã Liste des Projets INGQ</h3>
                        <div>
                            <button onclick="addINGQRow()" style="padding: 10px 20px; background: #48bb78; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 10px;">‚ûï Ajouter un projet</button>
                            <button onclick="exportINGQToExcel()" style="padding: 10px 20px; background: #4299e1; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">üì• Exporter Excel</button>
                        </div>
                    </div>

                    <p style="color: #000000; margin-bottom: 15px;">Total de projets INGQ: <strong><span id="ingqCount">0</span></strong></p>

                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; background: white;">
                            <thead>
                                <tr style="background: #667eea; color: white;">
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 10%;">Ordre</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 25%;">D√©sign. op√©r.</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 13%;">Poste technique</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 20%;">Commentaire</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 12%;">Contrainte</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 15%;">Document</th>
                                    <th style="padding: 12px; text-align: center; border: 1px solid #dee2e6; width: 5%;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="ingqTableBody">
                                <tr>
                                    <td colspan="7" style="padding: 30px; text-align: center; color: #666; border: 1px solid #dee2e6;">
                                        Aucun projet INGQ dans la liste. Cliquez sur "Ajouter un projet" pour en cr√©er un.
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t24" class="page">
            <div class="summary-container" style="max-width: 98%; padding: 20px;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">NOMMER L'√âQUIPE DE GESTION D'ARR√äTS (D6.0)</h2>
                </div>

                <!-- Section Tableau -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 30px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h3 style="margin: 0; color: #2d3748;">üìã Membres de l'√âquipe</h3>
                        <div>
                            <button onclick="addTeamMember()" style="padding: 10px 20px; background: #48bb78; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 10px;">‚ûï Ajouter un membre</button>
                            <button onclick="exportTeamToExcel()" style="padding: 10px 20px; background: #4299e1; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">üì• Exporter Excel</button>
                        </div>
                    </div>

                    <p style="color: #000000; margin-bottom: 15px;">Total de membres: <strong><span id="teamCount">0</span></strong></p>

                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; background: white;">
                            <thead>
                                <tr style="background: #667eea; color: white;">
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 20%;">Nom</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 20%;">R√¥le</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 15%;">T√©l√©phone</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 25%;">Adresse mail</th>
                                    <th style="padding: 12px; text-align: center; border: 1px solid #dee2e6; width: 5%;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="teamTableBody">
                                <tr>
                                    <td colspan="5" style="padding: 30px; text-align: center; color: #666; border: 1px solid #dee2e6;">
                                        Aucun membre dans l'√©quipe. Cliquez sur "Ajouter un membre" pour commencer.
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Section Organigramme -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="margin: 0 0 20px 0; color: #2d3748;">üè¢ Organigramme de l'√âquipe</h3>
                    <div id="organigramme" style="padding: 20px; min-height: 400px;">
                        <!-- L'organigramme sera g√©n√©r√© automatiquement ici -->
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t27" class="page">
            <div class="summary-container">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">√âTABLIR UNE STRAT√âGIE D'APPROVISIONNEMENT</h2>
                </div>
                <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0; color: #333;">Liste des Fournisseurs et Travaux</h3>
                        <div>
                            <button onclick="addApprovisionnementRow()" style="padding: 10px 20px; background: #48bb78; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 10px;">‚ûï Ajouter</button>
                            <button onclick="toggleHistoryColumns()" style="padding: 10px 20px; background: #4299e1; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">üóìÔ∏è Afficher/Cacher Historique</button>
                        </div>
                    </div>
                    <div class="summary-table-wrapper">
                        <table class="summary-table" id="approvisionnementTable">
                            <thead>
                                <tr>
                                    <th style="width: 15%; min-width: 150px;">Fournisseur</th>
                                    <th style="width: 15%; min-width: 150px;">Type de travaux</th>
                                    <th style="width: 40%; min-width: 300px;">Justification</th>
                                    <th style="width: 10%; min-width: 100px;">Estim√©</th>
                                    <th class="history-col" style="display: none; width: 10%; min-width: 100px;">Estim√© 2021</th>
                                    <th class="history-col" style="display: none; width: 10%; min-width: 100px;">Estim√© 2022</th>
                                    <th class="history-col" style="display: none; width: 10%; min-width: 100px;">Estim√© 2023</th>
                                    <th class="history-col" style="display: none; width: 10%; min-width: 100px;">Estim√© 2024</th>
                                    <th class="history-col" style="display: none; width: 10%; min-width: 100px;">Estim√© 2025</th>
                                    <th style="width: 10%; min-width: 100px;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="approvisionnementTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t29" class="page">
            <div class="summary-container" style="max-width: 98%; padding: 20px;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">DEMANDER LISTE OFFICIELS DES VPO √Ä LA PRODUCTION</h2>
                </div>

                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h3 style="margin: 0; color: #2d3748;">üìã Liste des VPO (V√©rifications Pr√©alables √† l'Ouverture)</h3>
                        <div>
                            <button onclick="addVPO()" style="padding: 10px 20px; background: #48bb78; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 10px;">‚ûï Ajouter un VPO</button>
                            <button onclick="exportVPOToExcel()" style="padding: 10px 20px; background: #4299e1; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">üì• Exporter Excel</button>
                        </div>
                    </div>

                    <p style="color: #000000; margin-bottom: 15px;">Total de VPO: <strong><span id="vpoCount">0</span></strong></p>

                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; background: white;">
                            <thead>
                                <tr style="background: #667eea; color: white;">
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 15%;">Nom du VPO</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 15%;">√âquipement concern√©</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 15%;">Poste technique</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 30%;">Description du VPO</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 20%;">Contraintes / Conditions</th>
                                    <th style="padding: 12px; text-align: center; border: 1px solid #dee2e6; width: 5%;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="vpoTableBody">
                                <tr>
                                    <td colspan="6" style="padding: 30px; text-align: center; color: #666; border: 1px solid #dee2e6;">
                                        Aucun VPO dans la liste. Cliquez sur "Ajouter un VPO" pour commencer.
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t30" class="page">
            <div class="summary-container" style="max-width: 98%; padding: 20px;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">FAIRE LES COMMANDE A LONG DELAIS</h2>
                </div>

                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h3 style="margin: 0; color: #2d3748;">üì¶ Pi√®ces avec D√©lai de Livraison ‚â• 90 Jours</h3>
                        <div>
                            <button onclick="syncT30FromIW38()" style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 10px;">üîÑ Charger depuis Gestion des Pi√®ces</button>
                            <button onclick="exportT30ToExcel()" style="padding: 10px 20px; background: #4299e1; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">üì• Exporter Excel</button>
                        </div>
                    </div>

                    <!-- Barre de recherche et tri -->
                    <div style="display: flex; gap: 15px; align-items: center; margin-bottom: 15px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                        <div style="flex: 1;">
                            <input type="text" placeholder="üîç Rechercher par Ordre, D√©signation ou Article..."
                                   oninput="window.updateT30Search(this.value)"
                                   style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 6px; font-size: 14px;">
                        </div>
                        <button onclick="window.toggleT30Sort()"
                                style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; white-space: nowrap;">
                            ‚áÖ Trier par D√©lai
                        </button>
                    </div>

                    <p style="color: #000000; margin-bottom: 15px;">Total de pi√®ces: <strong><span id="t30Count">0</span></strong></p>
                    <p style="color: #dc3545; margin-bottom: 10px; font-style: italic;">‚ö†Ô∏è Les pi√®ces avec un d√©lai > 120 jours sont affich√©es en rouge (tr√®s urgent)</p>
                    <p style="color: #2563eb; margin-bottom: 10px; font-style: italic;">‚ÑπÔ∏è La date de commande est calcul√©e automatiquement : Date d√©but d'arr√™t - D√©lai de livraison</p>

                    <div style="background: #f0f8ff; padding: 12px; border-radius: 6px; margin-bottom: 15px; border-left: 4px solid #667eea;">
                        <p style="margin: 0; font-weight: bold; color: #333;">üé® Couleurs de statut:</p>
                        <p style="margin: 5px 0 0 0; color: #555;">
                            <span style="display: inline-block; width: 20px; height: 15px; background: #f8d7da; border: 1px solid #ccc; margin-right: 5px; vertical-align: middle;"></span> <strong>Rouge</strong> = √Ä commander |
                            <span style="display: inline-block; width: 20px; height: 15px; background: #ffe0b2; border: 1px solid #ccc; margin: 0 5px; vertical-align: middle;"></span> <strong>Orange</strong> = Command√©/En transit |
                            <span style="display: inline-block; width: 20px; height: 15px; background: #d4edda; border: 1px solid #ccc; margin: 0 5px; vertical-align: middle;"></span> <strong>Vert</strong> = Re√ßu |
                            <span style="display: inline-block; width: 20px; height: 15px; background: #e0e0e0; border: 1px solid #ccc; margin: 0 5px; vertical-align: middle;"></span> <strong>Gris</strong> = Annul√©
                        </p>
                    </div>

                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; background: white;">
                            <thead style="position: sticky; top: 0; background: white; z-index: 5;">
                                <tr style="background: linear-gradient(145deg, #667eea, #764ba2); color: white;">
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 8%;">Ordre</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 20%;">D√©signation composant</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 10%;">Article</th>
                                    <th style="padding: 12px; text-align: center; border: 1px solid #dee2e6; width: 7%;">Qt√© r√©serv√©e</th>
                                    <th style="padding: 12px; text-align: center; border: 1px solid #dee2e6; width: 5%;">Unit√©</th>
                                    <th style="padding: 12px; text-align: center; border: 1px solid #dee2e6; width: 8%;">D√©lai (jours)</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 10%;">Date commande</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 10%;">Statut</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 22%;">Remarques</th>
                                </tr>
                            </thead>
                            <tbody id="t30TableBody">
                                <tr>
                                    <td colspan="9" style="padding: 30px; text-align: center; color: #666; border: 1px solid #dee2e6;">
                                        Aucune pi√®ce avec d√©lai > 90 jours. Cliquez sur "üîÑ Charger depuis Gestion des Pi√®ces" pour charger les donn√©es.
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== PAGE T60: COMMANDES √Ä LONG D√âLAI 60J ==================== -->
        <div id="detail-t60" class="page">
            <div class="summary-container" style="max-width: 98%; padding: 20px;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">FAIRE LES COMMANDES √Ä LONG D√âLAI 60J</h2>
                </div>

                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h3 style="margin: 0; color: #2d3748;">üì¶ Pi√®ces avec D√©lai de Livraison 60-89 Jours</h3>
                        <div>
                            <button onclick="syncT60FromIW38()" style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 10px;">üîÑ Charger depuis Gestion des Pi√®ces</button>
                            <button onclick="exportT60ToExcel()" style="padding: 10px 20px; background: #4299e1; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">üì• Exporter Excel</button>
                        </div>
                    </div>

                    <p style="color: #000000; margin-bottom: 15px;">Total de pi√®ces: <strong><span id="t60Count">0</span></strong></p>
                    <p style="color: #ffa500; margin-bottom: 10px; font-style: italic;">‚ö†Ô∏è Les pi√®ces avec un d√©lai ‚â• 75 jours sont affich√©es en orange (urgent)</p>
                    <p style="color: #2563eb; margin-bottom: 15px; font-style: italic;">‚ÑπÔ∏è La date de commande est calcul√©e automatiquement : Date d√©but d'arr√™t - D√©lai de livraison</p>

                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; background: white;">
                            <thead style="position: sticky; top: 0; background: white; z-index: 5;">
                                <tr style="background: linear-gradient(145deg, #667eea, #764ba2); color: white;">
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 8%;">Ordre</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 20%;">D√©signation composant</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 10%;">Article</th>
                                    <th style="padding: 12px; text-align: center; border: 1px solid #dee2e6; width: 7%;">Qt√© r√©serv√©e</th>
                                    <th style="padding: 12px; text-align: center; border: 1px solid #dee2e6; width: 5%;">Unit√©</th>
                                    <th style="padding: 12px; text-align: center; border: 1px solid #dee2e6; width: 8%;">D√©lai (jours)</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 10%;">Date commande</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 10%;">Statut</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 22%;">Remarques</th>
                                </tr>
                            </thead>
                            <tbody id="t60TableBody">
                                <tr>
                                    <td colspan="9" style="padding: 30px; text-align: center; color: #666; border: 1px solid #dee2e6;">
                                        Aucune pi√®ce avec d√©lai 60-89 jours. Cliquez sur "üîÑ Charger depuis Gestion des Pi√®ces" pour charger les donn√©es.
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-suivi-pieces-delai" class="page">
    <div class="summary-container" style="max-width: 98%; padding: 20px;">
        <!-- En-t√™te principal -->
        <div style="display: flex; align-items: center; margin-bottom: 25px;">
            <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
            <h2 style="margin: 0; color: #333;">üì¶ SUIVI DES LOTS MAGASIN - COMMANDES √Ä LONG D√âLAI</h2>
        </div>

        <!-- L√©gende des couleurs globale -->
        <div style="background: #f0f8ff; padding: 15px; border-radius: 8px; margin-bottom: 25px; border-left: 4px solid #667eea;">
            <p style="margin: 0; font-weight: bold; color: #333;">üé® L√©gende des statuts:</p>
            <p style="margin: 8px 0 0 0; color: #555;">
                <span style="display: inline-block; width: 20px; height: 15px; background: #f8d7da; border: 1px solid #ccc; margin-right: 5px; vertical-align: middle;"></span> <strong>Rouge</strong> = √Ä commander |
                <span style="display: inline-block; width: 20px; height: 15px; background: #ffe0b2; border: 1px solid #ccc; margin: 0 5px; vertical-align: middle;"></span> <strong>Orange</strong> = Command√©/En transit |
                <span style="display: inline-block; width: 20px; height: 15px; background: #d4edda; border: 1px solid #ccc; margin: 0 5px; vertical-align: middle;"></span> <strong>Vert</strong> = Re√ßu |
                <span style="display: inline-block; width: 20px; height: 15px; background: #e0e0e0; border: 1px solid #ccc; margin: 0 5px; vertical-align: middle;"></span> <strong>Gris</strong> = Annul√©
            </p>
        </div>

        <!-- SECTION 1: Pi√®ces > 90 jours -->
        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 25px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 3px solid #dc3545; padding-bottom: 10px;">
                <h3 style="margin: 0; color: #dc3545;">üî¥ Pi√®ces avec D√©lai > 90 Jours</h3>
                <div>
                    <button onclick="syncT30FromIW38()" style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 10px;">üîÑ Charger depuis Gestion des Pi√®ces</button>
                    <button onclick="exportT30ToExcel()" style="padding: 10px 20px; background: #4299e1; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">üì• Exporter Excel</button>
                </div>
            </div>

            <!-- Barre de recherche et tri -->
            <div style="display: flex; gap: 15px; align-items: center; margin-bottom: 15px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                <div style="flex: 1;">
                    <input type="text" placeholder="üîç Rechercher par Ordre, D√©signation ou Article..."
                           oninput="window.updateT30Search(this.value)"
                           style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 6px; font-size: 14px;">
                </div>
                <button onclick="window.toggleT30Sort()"
                        style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; white-space: nowrap;">
                    ‚áÖ Trier par D√©lai
                </button>
            </div>

            <p style="color: #000000; margin-bottom: 10px;">Total de pi√®ces: <strong><span id="t30Count">0</span></strong></p>
            <p style="color: #dc3545; margin-bottom: 15px; font-style: italic;">‚ö†Ô∏è Les pi√®ces avec un d√©lai > 120 jours sont affich√©es en rouge fonc√© (tr√®s urgent)</p>

            <div style="overflow-x: auto; max-height: 400px; overflow-y: auto; border: 1px solid #dee2e6; border-radius: 8px;">
                <table style="width: 100%; border-collapse: collapse; background: white;">
                    <thead style="position: sticky; top: 0; background: white; z-index: 5;">
                        <tr style="background: linear-gradient(145deg, #dc3545, #c82333); color: white;">
                            <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 8%;">Ordre</th>
                            <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 20%;">D√©signation composant</th>
                            <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 10%;">Article</th>
                            <th style="padding: 12px; text-align: center; border: 1px solid #dee2e6; width: 7%;">Qt√© r√©serv√©e</th>
                            <th style="padding: 12px; text-align: center; border: 1px solid #dee2e6; width: 5%;">Unit√©</th>
                            <th style="padding: 12px; text-align: center; border: 1px solid #dee2e6; width: 8%;">D√©lai (jours)</th>
                            <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 10%;">Date commande</th>
                            <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 10%;">Statut</th>
                            <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 22%;">Remarques</th>
                        </tr>
                    </thead>
                    <tbody id="t30TableBody">
                        <tr>
                            <td colspan="9" style="padding: 30px; text-align: center; color: #666; border: 1px solid #dee2e6;">
                                Aucune pi√®ce avec d√©lai > 90 jours. Cliquez sur "üîÑ Charger depuis Gestion des Pi√®ces" pour charger les donn√©es.
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- SECTION 2: Pi√®ces 60-89 jours -->
        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 25px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 3px solid #ff8c00; padding-bottom: 10px;">
                <h3 style="margin: 0; color: #ff8c00;">üü† Pi√®ces avec D√©lai 60-89 Jours</h3>
                <div>
                    <button onclick="syncT60FromIW38()" style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 10px;">üîÑ Charger depuis Gestion des Pi√®ces</button>
                    <button onclick="exportT60ToExcel()" style="padding: 10px 20px; background: #4299e1; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">üì• Exporter Excel</button>
                </div>
            </div>

            <p style="color: #000000; margin-bottom: 10px;">Total de pi√®ces: <strong><span id="t60Count">0</span></strong></p>
            <p style="color: #ff8c00; margin-bottom: 15px; font-style: italic;">‚ö†Ô∏è Les pi√®ces avec un d√©lai >= 75 jours sont affich√©es en orange (urgent)</p>

            <div style="overflow-x: auto; max-height: 400px; overflow-y: auto; border: 1px solid #dee2e6; border-radius: 8px;">
                <table style="width: 100%; border-collapse: collapse; background: white;">
                    <thead style="position: sticky; top: 0; background: white; z-index: 5;">
                        <tr style="background: linear-gradient(145deg, #ff8c00, #e67e00); color: white;">
                            <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 8%;">Ordre</th>
                            <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 22%;">D√©signation composant</th>
                            <th style="padding: 12px; text-align: center; border: 1px solid #dee2e6; width: 7%;">Qt√© r√©serv√©e</th>
                            <th style="padding: 12px; text-align: center; border: 1px solid #dee2e6; width: 5%;">Unit√©</th>
                            <th style="padding: 12px; text-align: center; border: 1px solid #dee2e6; width: 8%;">D√©lai (jours)</th>
                            <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 10%;">Date commande</th>
                            <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 14%;">Fournisseur</th>
                            <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 12%;">Statut</th>
                            <th style="padding: 12px; text-align: left; border: 1px solid #dee2e6; width: 14%;">Remarques</th>
                        </tr>
                    </thead>
                    <tbody id="t60TableBody">
                        <tr>
                            <td colspan="9" style="padding: 30px; text-align: center; color: #666; border: 1px solid #dee2e6;">
                                Aucune pi√®ce avec d√©lai 60-89 jours. Cliquez sur "üîÑ Charger depuis Gestion des Pi√®ces" pour charger les donn√©es.
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- SECTION 3: Pi√®ces 30-59 jours -->
        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 3px solid #ffc107; padding-bottom: 10px;">
                <h3 style="margin: 0; color: #ffc107;">üü° Pi√®ces avec D√©lai 30-59 Jours</h3>
                <div>
                    <button onclick="syncT30FromIW38()" style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 10px;">üîÑ Charger depuis Gestion des Pi√®ces</button>
                    <button onclick="exportT30ToExcel()" style="padding: 10px 20px; background: #4299e1; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">üì• Exporter Excel</button>
                </div>
            </div>

            <div style="background: #fff3cd; padding: 15px; border-radius: 8px; border-left: 4px solid #ffc107; margin-bottom: 20px;">
                <strong>‚ö†Ô∏è Important:</strong> Ces commandes doivent √™tre pass√©es au minimum 30 jours avant l'arr√™t.
            </div>

            <div style="max-height: 400px; overflow-y: auto; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px; background: #fffef0;">
                <div style="display: grid; gap: 20px;">
                    <div>
                        <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #555;">Date limite de commande</label>
                        <input type="date" id="t30OrderDeadline" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 5px;">
                    </div>

                    <div>
                        <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #555;">Liste des articles (30-59 jours)</label>
                        <textarea id="t30Items" rows="6" placeholder="Liste des articles √† commander avec quantit√©s..."
                                  style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 5px; resize: vertical;"></textarea>
                    </div>

                    <div>
                        <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #555;">Fournisseurs</label>
                        <textarea id="t30Suppliers" rows="4" placeholder="Liste des fournisseurs contact√©s..."
                                  style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 5px; resize: vertical;"></textarea>
                    </div>

                    <div>
                        <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #555;">Statut et suivi</label>
                        <textarea id="t30Tracking" rows="4" placeholder="Suivi des commandes pass√©es..."
                                  style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 5px; resize: vertical;"></textarea>
                    </div>
                </div>

                <div style="display: flex; gap: 15px; justify-content: flex-end; margin-top: 20px;">
                    <button onclick="saveT30Data()"
                            class="btn" style="background: #28a745; color: white; padding: 12px 30px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        üíæ Sauvegarder
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="detail-t43" class="page">
            <div class="summary-container">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">√âTABLIR LA DATE DE L'ARR√äT √âLECTRIQUE (MEMOS OFFICIELS)</h2>
                </div>
                <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <div style="margin-bottom: 30px;">
                        <h3 style="color: #667eea; margin-bottom: 20px;">üìÖ Informations sur l'Arr√™t √âlectrique</h3>

                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px;">
                            <!-- Date de d√©but -->
                            <div>
                                <label style="display: block; font-weight: bold; margin-bottom: 8px; color: #333;">
                                    üìÖ Date de D√©but de l'Arr√™t √âlectrique:
                                </label>
                                <input
                                    type="date"
                                    id="t43-dateDebut"
                                    style="width: 100%; padding: 12px; border: 2px solid #667eea; border-radius: 8px; font-size: 1em;"
                                    onchange="saveT43Data()"
                                >
                            </div>

                            <!-- Dur√©e -->
                            <div>
                                <label style="display: block; font-weight: bold; margin-bottom: 8px; color: #333;">
                                    ‚è±Ô∏è Dur√©e (en jours):
                                </label>
                                <input
                                    type="number"
                                    id="t43-duree"
                                    min="1"
                                    max="30"
                                    placeholder="Ex: 3"
                                    style="width: 100%; padding: 12px; border: 2px solid #667eea; border-radius: 8px; font-size: 1em;"
                                    onchange="saveT43Data()"
                                >
                            </div>
                        </div>

                        <!-- Zone de texte pour notes/m√©mo -->
                        <div>
                            <label style="display: block; font-weight: bold; margin-bottom: 8px; color: #333;">
                                üìù Notes / Contenu du M√©mo:
                            </label>
                            <textarea
                                id="t43-notes"
                                rows="8"
                                placeholder="Entrez ici les d√©tails du m√©mo officiel concernant l'arr√™t √©lectrique..."
                                style="width: 100%; padding: 12px; border: 2px solid #667eea; border-radius: 8px; font-size: 1em; resize: vertical; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;"
                                onchange="saveT43Data()"
                            ></textarea>
                        </div>

                        <div style="margin-top: 20px; padding: 15px; background: #f0f4ff; border-left: 4px solid #667eea; border-radius: 8px;">
                            <strong style="color: #667eea;">üí° Rappel:</strong>
                            <p style="margin: 5px 0 0 0; color: #666;">
                                Assurez-vous de communiquer ces informations √† tous les employ√©s d'entretien et d'op√©ration via les m√©mos officiels.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t45" class="page">
            <div class="summary-container" style="max-width: 98%; padding: 20px;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333; flex: 1;">√âTABLIR LA LISTE DES TRAVAUX EN ESPACE CLOS</h2>
                </div>

                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <div style="display: flex; gap: 15px; margin-bottom: 15px; align-items: center; flex-wrap: wrap;">
                        <p style="margin: 0; color: #666; flex: 1; min-width: 300px;">
                            Cette liste contient tous les travaux en espace clos extraits de IW37N (EP- ou EC- dans Design. op√©ration).
                        </p>
                        <button onclick="syncEspaceClosFromIw37n()"
                                style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; white-space: nowrap;">
                            üîÑ Synchroniser avec IW37N
                        </button>
                        <button onclick="exportEspaceClosToExcel()"
                                style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; white-space: nowrap;">
                            üì• Exporter Excel
                        </button>
                    </div>

                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin-bottom: 15px;">
                        <div style="background: #fff3cd; padding: 10px; border-radius: 5px;">
                            <strong>Total d'espaces clos:</strong> <span id="espaceClosCount">0</span>
                        </div>
                        <div style="background: #f8d7da; padding: 10px; border-radius: 5px;">
                            <strong>Surveillants requis:</strong> <span id="surveillantsCount">0</span>
                        </div>
                    </div>
                </div>

                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <div style="overflow-x: auto; max-height: calc(100vh - 350px); overflow-y: auto;">
                        <table class="summary-table" style="width: 100%; border-collapse: collapse;">
                            <thead style="position: sticky; top: 0; background: white; z-index: 10;">
                                <tr style="background: linear-gradient(135deg, #c9941a 0%, #c9941a 100%); color: white;">
                                    <th style="padding: 12px; border: 1px solid #dee2e6; min-width: 200px;">Espace clos</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; white-space: nowrap;">Ordre</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; min-width: 300px;">D√©sign. op√©r.</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; min-width: 200px;">Poste technique</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; min-width: 150px;">Reclassification</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; min-width: 200px;">Commentaire</th>
                                </tr>
                            </thead>
                            <tbody id="espaceClosTableBody">
                                <tr>
                                    <td colspan="6" style="padding: 30px; text-align: center; color: #666;">
                                        Aucun espace clos dans la liste. Cliquez sur "Synchroniser avec IW37N" pour importer les donn√©es.
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Section Liste Unique des Espaces Clos -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-top: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h3 style="color: #c9941a; margin: 0; border-bottom: 2px solid #c9941a; padding-bottom: 10px; flex: 1;">
                            üìã Liste Unique des Espaces Clos (<span id="espaceClosUniqueCount">0</span>)
                        </h3>
                        <button onclick="window.exportEspaceClosUniquePDF()" style="padding: 10px 20px; background: linear-gradient(145deg, #e53935, #d32f2f); color: white; border: none; border-radius: 12px; cursor: pointer; font-weight: 600; box-shadow: 5px 5px 10px rgba(163, 177, 198, 0.5), -5px -5px 10px rgba(255, 255, 255, 0.3); transition: all 0.3s ease; margin-left: 15px;">
                            üìÑ Export PDF
                        </button>
                    </div>
                    <div style="background: #f0f8ff; padding: 12px; border-radius: 6px; margin-bottom: 15px; border-left: 4px solid #667eea;">
                        <p style="color: #333; font-size: 0.9em; margin: 0; margin-bottom: 8px;">
                            üí° <strong>Astuce:</strong> Cliquez sur une carte pour filtrer le tableau ci-dessus
                        </p>
                        <p style="color: #555; font-size: 0.85em; margin: 0;">
                            üé® <strong>Couleurs:</strong>
                            <span style="color: #28a745; font-weight: bold;">‚ñ† Vert</span> = Tous reclassifi√©s "Non espace clos" |
                            <span style="color: #dc3545; font-weight: bold;">‚ñ† Rouge</span> = Au moins un "Espace clos" |
                            <span style="color: #c9941a; font-weight: bold;">‚ñ† Orange</span> = √Ä v√©rifier
                        </p>
                    </div>
                    <div id="espaceClosListeUnique" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px;">
                        <!-- Liste g√©n√©r√©e par JavaScript -->
                        <div style="text-align: center; padding: 40px; color: #999; grid-column: 1 / -1;">
                            Aucun espace clos. Synchronisez avec IW37N pour commencer.
                        </div>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t50" class="page">
            <div class="summary-container" style="max-width: 98%; padding: 20px;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333; flex: 1;">FAIRE RENCONTRE POUR LES TRAVAUX DES TOURS DE REFROIDISSEMENT</h2>
                </div>

                <!-- Barre d'actions globales -->
                <div style="background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px; display: flex; gap: 10px; align-items: center;">
                    <button onclick="window.toursActions.addNewRencontre()"
                            style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        ‚ûï Nouvelle Rencontre
                    </button>
                    <button onclick="window.toursActions.exportToursRefroidissementComplet()"
                            style="padding: 10px 20px; background: #ff9800; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        üìÑ Exporter le Rapport Complet
                    </button>
                    <span style="margin-left: auto; color: #666; font-size: 0.9em;">üí° G√©rez plusieurs comptes rendus de rencontre</span>
                </div>

                <div style="display: grid; grid-template-columns: 250px 1fr; gap: 20px;">
                    <!-- Sidebar: Liste des rencontres -->
                    <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); height: fit-content;">
                        <h3 style="color: #667eea; margin: 0 0 15px 0;">üìö Mes Rencontres</h3>
                        <div id="rencontresListContainer">
                            <!-- Liste g√©n√©r√©e par JS -->
                        </div>
                    </div>

                    <!-- Contenu principal -->
                    <div style="display: flex; flex-direction: column; gap: 20px;">

                <!-- En-t√™te de la rencontre s√©lectionn√©e -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); color: white;">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div style="font-size: 2em;">üìã</div>
                        <div style="flex: 1;">
                            <div style="font-size: 0.85em; opacity: 0.9; margin-bottom: 5px;">Rencontre en cours d'√©dition</div>
                            <input type="text" id="toursRencontreTitre"
                                   placeholder="Nom de la rencontre"
                                   onchange="window.toursActions.updateRencontreTitre(this.value)"
                                   style="width: 100%; padding: 10px; border: none; border-radius: 5px; font-size: 1.2em; font-weight: bold; background: rgba(255,255,255,0.95); color: #333;">
                        </div>
                    </div>
                </div>

                <!-- Section Liste des Travaux -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">üìã Liste des Travaux</h3>

                    <div style="margin-bottom: 15px;">
                        <button onclick="addToursRefroidissementTravail()"
                                style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            ‚ûï Ajouter un Travail
                        </button>
                        <button onclick="exportToursRefroidissementToExcel()"
                                style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-left: 10px;">
                            üì• Exporter Excel
                        </button>
                    </div>

                    <div style="overflow-x: auto; max-height: 400px; overflow-y: auto;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.9em;">
                            <thead style="position: sticky; top: 0; background: white; z-index: 10;">
                                <tr style="background: #f8f9fa; border-bottom: 2px solid #dee2e6;">
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 300px;">Description du travail</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; white-space: nowrap;">Responsable</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; white-space: nowrap;">Priorit√©</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 150px;">Commentaires</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; white-space: nowrap;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="toursRefroidissementTableBody">
                                <tr>
                                    <td colspan="5" style="padding: 30px; text-align: center; color: #666;">
                                        Aucun travail ajout√©. Cliquez sur "Ajouter un Travail" pour commencer.
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Section Compte Rendu de Rencontre -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">üìù Compte Rendu de Rencontre</h3>

                    <div style="margin-bottom: 15px;">
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">Date de la rencontre:</label>
                        <input type="date" id="toursDateRencontre" onchange="saveToursRefroidissementData()"
                               style="padding: 8px; border: 1px solid #ced4da; border-radius: 4px; width: 200px;">
                    </div>

                    <div style="margin-bottom: 15px;">
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">Participants:</label>
                        <input type="text" id="toursParticipants" onchange="saveToursRefroidissementData()"
                               placeholder="Ex: Jean Dupont, Marie Martin, etc."
                               style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                    </div>

                    <div style="margin-bottom: 15px;">
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">Notes et d√©cisions:</label>
                        <textarea id="toursCompteRendu" onchange="saveToursRefroidissementData()"
                                  rows="10"
                                  placeholder="Saisir les notes, d√©cisions et points importants de la rencontre..."
                                  style="width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 4px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; resize: vertical;"></textarea>
                    </div>
                </div>

                <!-- Section Documents PDF -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="color: #667eea; margin-bottom: 15px;">üìé Documents et Soumissions</h3>

                    <div style="margin-bottom: 15px;">
                        <button onclick="addToursDocument()"
                                style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            ‚ûï Ajouter un Document
                        </button>
                    </div>

                    <div id="toursDocumentsList" style="display: flex; flex-direction: column; gap: 10px;">
                        <p style="color: #000000; text-align: center; padding: 20px;">Aucun document ajout√©.</p>
                    </div>
                </div>

                    </div> <!-- Fin contenu principal -->
                </div> <!-- Fin grid -->
            </div> <!-- Fin summary-container -->
        </div> <!-- Fin detail-t50 -->

<div id="detail-t51" class="page">
            <div class="summary-container" style="max-width: 98%; padding: 20px;">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center;">
                        <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                        <h2 style="margin: 0; color: #333;">D√âP√îT DES SOUMISSIONS DES ENTREPRENEURS</h2>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button onclick="syncT51Entrepreneurs()" style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            üîÑ Synchroniser IW37N
                        </button>
                        <button onclick="addT51Soumission()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            ‚ûï Nouvelle Soumission
                        </button>
                        <button onclick="exportT51ToExcel()" style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            üì§ Exporter Excel
                        </button>
                    </div>
                </div>

                <!-- Statistiques -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <div style="background: #e3f2fd; padding: 20px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2em; font-weight: bold; color: #1976d2;" id="t51TotalSoumissions">0</div>
                        <div style="color: #000; margin-top: 5px;">Total Soumissions</div>
                    </div>
                    <div style="background: #fff3cd; padding: 20px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2em; font-weight: bold; color: #856404;" id="t51EnAttente">0</div>
                        <div style="color: #000; margin-top: 5px;">En Attente</div>
                    </div>
                    <div style="background: #d4edda; padding: 20px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2em; font-weight: bold; color: #155724;" id="t51Re√ßues">0</div>
                        <div style="color: #000; margin-top: 5px;">Re√ßues</div>
                    </div>
                    <div style="background: #f8d7da; padding: 20px; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2em; font-weight: bold; color: #721c24;" id="t51Relances">0</div>
                        <div style="color: #000; margin-top: 5px;">Relances Requises</div>
                    </div>
                </div>

                <!-- Tableau des Soumissions -->
                <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="margin-top: 0; color: #667eea;">üìã Liste des Soumissions</h3>

                    <div class="summary-table-wrapper" style="max-height: 600px; overflow-y: auto;">
                        <table class="summary-table">
                            <thead>
                                <tr>
                                    <th style="width: 12%;">Entrepreneur</th>
                                    <th style="width: 8%;">Code SAP</th>
                                    <th style="width: 15%;">Commentaires</th>
                                    <th style="width: 9%;">Date Demande</th>
                                    <th style="width: 7%;">Relance 1</th>
                                    <th style="width: 7%;">Relance 2</th>
                                    <th style="width: 7%;">Relance 3</th>
                                    <th style="width: 9%;">Date R√©ception</th>
                                    <th style="width: 10%;">N¬∞ Soumission</th>
                                    <th style="width: 10%;">Documents</th>
                                    <th style="width: 6%;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="t51SoumissionsTableBody">
                                <tr><td colspan="11" style="text-align: center; padding: 40px; color: #999;">
                                    Aucune soumission enregistr√©e.<br>
                                    Cliquez sur "‚ûï Nouvelle Soumission" ou "üîÑ Synchroniser IW37N" pour commencer.
                                </td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t55" class="page">
    <div class="card">
        <div style="display: flex; align-items: center; margin-bottom: 20px; justify-content: space-between;">
            <div style="display: flex; align-items: center;">
                <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                <h2 style="margin: 0; color: #333; flex: 1;">FAIRE DEVIS ET CORRECTION</h2>
            </div>
            <div style="display: flex; gap: 10px;">
                <button onclick="switchPage('detail-t55-historique')" style="padding: 12px 24px; background: linear-gradient(145deg, #4299e1, #3182ce); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 16px;">
                    üìã Historique
                </button>
                <button onclick="exportT55ToPDF()" id="t55ExportPDFBtn" style="display: none; padding: 12px 24px; background: linear-gradient(145deg, #dc3545, #c82333); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 16px;">
                    üìÑ Exporter PDF
                </button>
            </div>
        </div>

        <!-- Section Template PDF -->
        <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
            <h3 style="color: #667eea; margin-top: 0;">üìÑ Template PDF Global</h3>

            <div style="display: flex; gap: 15px; align-items: center; margin-bottom: 10px;">
                <div style="flex: 1;">
                    <input type="file" id="t55PdfTemplateInput" accept=".pdf" style="display: none;" onchange="uploadT55PdfTemplate(this.files)">
                    <button onclick="document.getElementById('t55PdfTemplateInput').click()"
                            style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        üì§ Upload Template PDF
                    </button>
                    <span id="t55PdfTemplateStatus" style="margin-left: 15px; color: #666; font-style: italic;">
                        Aucun template charg√©
                    </span>
                </div>
            </div>
            <p style="margin: 0; color: #666; font-size: 0.9em;">
                üí° Ce template sera utilis√© pour g√©n√©rer les devis PDF de tous les entrepreneurs
            </p>
        </div>

        <!-- Section S√©lection Entrepreneur -->
        <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
            <h3 style="color: #667eea; margin-top: 0;">üë∑ S√©lection de l'Entrepreneur</h3>

            <div style="display: flex; gap: 15px; align-items: flex-start; margin-bottom: 20px;">
                <div style="flex: 1;">
                    <label style="display: block; font-weight: bold; margin-bottom: 8px; color: #333;">Entrepreneur (Post.trav.op√©r. IW37N):</label>
                    <select id="t55EntrepreneurSelect" onchange="loadT55EntrepreneurData()"
                            style="width: 100%; padding: 12px; border: 2px solid #667eea; border-radius: 8px; font-size: 1em; cursor: pointer;">
                        <option value="">-- S√©lectionner un entrepreneur --</option>
                    </select>
                </div>
                <div style="padding-top: 30px;">
                    <button onclick="syncT55Entrepreneurs()"
                            style="padding: 12px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; white-space: nowrap;">
                        üîÑ Synchroniser IW37N
                    </button>
                </div>
            </div>
        </div>

        <!-- Formulaire Devis (cach√© par d√©faut) -->
        <div id="t55DevisForm" style="display: none;">

            <!-- Section 1: Informations G√©n√©rales -->
            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                <h3 style="color: #667eea; margin-top: 0; border-bottom: 2px solid #667eea; padding-bottom: 10px;">üìã Informations G√©n√©rales</h3>

                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">Titre du devis:</label>
                        <input type="text" id="t55TitreDevis" onchange="saveT55Data()" value="Devis g√©n√©ral"
                               style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">Sp√©cialit√©:</label>
                        <select id="t55Specialite" onchange="saveT55Data()"
                                style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                            <option value="">-- S√©lectionner --</option>
                            <option value="M√©canique">M√©canique (MEC)</option>
                            <option value="√âlectrique">√âlectrique</option>
                            <option value="Tuyauterie">Tuyauterie</option>
                            <option value="Structure">Structure</option>
                            <option value="R√©fractaire">R√©fractaire</option>
                            <option value="Instrumentation">Instrumentation</option>
                            <option value="Coh√©sion">Coh√©sion (COH)</option>
                            <option value="Incendie">Incendie (INC)</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">Lieu:</label>
                        <input type="text" id="t55Lieu" onchange="saveT55Data()" value="Rio Tinto Fer et Titane, Sorel-Tracy, Qu√©bec, Canada"
                               style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">Type de contrat:</label>
                        <input type="text" id="t55TypeContrat" onchange="saveT55Data()" value="D√©penses contr√¥l√©es"
                               style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                </div>
            </div>

            <!-- Section 2: Dates Cl√©s -->
            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                <h3 style="color: #667eea; margin-top: 0; border-bottom: 2px solid #667eea; padding-bottom: 10px;">üìÖ 7. DATES CL√âS</h3>

                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">D√©but des visites:</label>
                        <input type="date" id="t55DateDebutVisites" onchange="saveT55Data()"
                               style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">Remise soumission:</label>
                        <input type="date" id="t55DateRemiseSoumission" onchange="saveT55Data()"
                               style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">Adjudication:</label>
                        <input type="date" id="t55DateAdjudication" onchange="saveT55Data()"
                               style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">Liste Cognibox:</label>
                        <input type="date" id="t55DateListeCognibox" onchange="saveT55Data()"
                               style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">D√©but mobilisation:</label>
                        <input type="date" id="t55DateDebutMobilisation" onchange="saveT55Data()"
                               style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">Fin mobilisation:</label>
                        <input type="date" id="t55DateFinMobilisation" onchange="saveT55Data()"
                               style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">D√©but arr√™t:</label>
                        <input type="date" id="t55DateDebutArret" onchange="saveT55Data()"
                               style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">Fin arr√™t:</label>
                        <input type="date" id="t55DateFinArret" onchange="saveT55Data()"
                               style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">D√©mobilisation:</label>
                        <input type="date" id="t55DateDemobilisation" onchange="saveT55Data()"
                               style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                </div>
            </div>

            <!-- Section 3: DESSINS -->
            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="color: #667eea; margin: 0; border-bottom: 2px solid #667eea; padding-bottom: 10px; flex: 1;">üìê DESSINS FAISANT PARTIE DE CETTE SP√âCIFICATION</h3>
                    <button onclick="addT55DessinRow()" style="padding: 8px 16px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                        ‚ûï Ajouter
                    </button>
                </div>

                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f8f9fa;">
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 30%;">Num√©ro de dessin</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: center; width: 15%;">R√©vision</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 50%;">Titre</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: center; width: 5%;">‚ùå</th>
                            </tr>
                        </thead>
                        <tbody id="t55DessinsTableBody">
                            <tr><td colspan="4" style="padding: 20px; text-align: center; color: #999;">Aucun dessin. Cliquez sur "Ajouter" pour commencer.</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Section 4A: CONVERTISSEUR -->
            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="color: #667eea; margin: 0; border-bottom: 2px solid #667eea; padding-bottom: 10px; flex: 1;">‚öôÔ∏è 6.2 TRAVAUX M√âCANIQUES - CONVERTISSEUR</h3>
                    <button onclick="addT55ConvertisseurRow()" style="padding: 8px 16px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                        ‚ûï Ajouter
                    </button>
                </div>

                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f8f9fa;">
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 8%;"># Item</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 12%;">√âquipement</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 10%;"># Ordre</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 25%;">Description des travaux</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 13%;">Mat√©riel fourni par RTFT</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 13%;">Mat√©riel fourni par entrepreneur</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 14%;">Dessins/ r√©f√©rences</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: center; width: 5%;">‚ùå</th>
                            </tr>
                        </thead>
                        <tbody id="t55ConvertisseurTableBody">
                            <tr><td colspan="8" style="padding: 20px; text-align: center; color: #999;">Aucun travail Convertisseur. Cliquez sur "Ajouter" pour commencer.</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Section 4B: COUL√âE CONTINUE -->
            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="color: #667eea; margin: 0; border-bottom: 2px solid #667eea; padding-bottom: 10px; flex: 1;">üèóÔ∏è 6.2 TRAVAUX M√âCANIQUES - COUL√âE CONTINUE</h3>
                    <button onclick="addT55CouleeContinueRow()" style="padding: 8px 16px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                        ‚ûï Ajouter
                    </button>
                </div>

                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f8f9fa;">
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 8%;"># Item</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 12%;">√âquipement</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 10%;"># Ordre</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 25%;">Description des travaux</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 13%;">Mat√©riel fourni par RTFT</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 13%;">Mat√©riel fourni par entrepreneur</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 14%;">Dessins/ r√©f√©rences</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: center; width: 5%;">‚ùå</th>
                            </tr>
                        </thead>
                        <tbody id="t55CouleeContinueTableBody">
                            <tr><td colspan="8" style="padding: 20px; text-align: center; color: #999;">Aucun travail Coul√©e continue. Cliquez sur "Ajouter" pour commencer.</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Section 5: Remarques g√©n√©rales -->
            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                <h3 style="color: #667eea; margin-top: 0; border-bottom: 2px solid #667eea; padding-bottom: 10px;">üìù Remarques et Notes</h3>

                <div style="margin-bottom: 15px;">
                    <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">Remarques g√©n√©rales:</label>
                    <textarea id="t55RemarquesGenerales" onchange="saveT55Data()" rows="4"
                              placeholder="Notes, commentaires, conditions particuli√®res..."
                              style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-family: Arial, sans-serif; resize: vertical;"></textarea>
                </div>

                <div>
                    <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">Corrections demand√©es:</label>
                    <textarea id="t55Corrections" onchange="saveT55Data()" rows="4"
                              placeholder="Liste des corrections √† apporter..."
                              style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-family: Arial, sans-serif; resize: vertical;"></textarea>
                </div>
            </div>

            <!-- Section 6: Historique des Devis et Corrections -->
            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="color: #667eea; margin: 0; border-bottom: 2px solid #667eea; padding-bottom: 10px; flex: 1;">üìö Historique des Devis et Corrections</h3>
                    <button onclick="addT55HistoriqueRow()" style="padding: 8px 16px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                        ‚ûï Ajouter
                    </button>
                </div>

                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f8f9fa;">
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 5%;">Occ.</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 6%;">R√©vison</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 6%;">Item</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 10%;">Equipement</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 8%;">Ordre</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 20%;">Description des travaux</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 10%;">Mat√©riel RTFT</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 10%;">Mat√©riel Entr.</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 10%;">Dessins - R√©f.</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 8%;">Gammes</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; width: 10%;">CptrGrpGam</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: center; width: 3%;">‚ùå</th>
                            </tr>
                        </thead>
                        <tbody id="t55HistoriqueTableBody">
                            <tr><td colspan="12" style="padding: 20px; text-align: center; color: #999;">Aucune entr√©e. Cliquez sur "Ajouter" pour commencer.</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
</div>

<div id="detail-t55-historique" class="page">
    <div class="card">
        <div style="display: flex; align-items: center; margin-bottom: 20px;">
            <button onclick="switchPage('detail-t55')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
            <h2 style="margin: 0; color: #333; flex: 1;">HISTORIQUE DES DEVIS ET CORRECTIONS</h2>
        </div>

        <!-- Barre d'actions -->
        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h3 style="margin: 0; color: #333;">üìã Donn√©es Historiques</h3>
                <div style="display: flex; gap: 10px;">
                    <input type="file" id="t55HistoriqueExcelUpload" accept=".xlsx,.xls" style="display: none;" onchange="window.t55Historique.uploadFromExcel(event)">
                    <button onclick="document.getElementById('t55HistoriqueExcelUpload').click()"
                            style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        üì§ Upload Excel
                    </button>
                    <button onclick="window.t55Historique.addRow()"
                            style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        ‚ûï Ajouter Ligne
                    </button>
                    <button onclick="window.t55Historique.exportToExcel()"
                            style="padding: 10px 20px; background: #4299e1; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        üì• Exporter Excel
                    </button>
                    <button onclick="window.t55Historique.clearAll()"
                            style="padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        üóëÔ∏è Effacer Tout
                    </button>
                </div>
            </div>
            <p style="margin: 0; color: #666; font-size: 0.95em;">
                Total: <strong><span id="t55HistoriqueCount">0</span></strong> enregistrement(s)
            </p>
        </div>

        <!-- Tableau Historique -->
        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            <div style="overflow-x: auto;">
                <table style="width: 100%; border-collapse: collapse; font-size: 0.9em;">
                    <thead>
                        <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 80px;">Occ.</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 100px;">R√©vision</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 100px;">Item</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 150px;">√âquipement</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 100px;">Ordre</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 300px;">Description des travaux</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 200px;">Mat√©riel fournis par RTFT</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 200px;">Mat√©riel fournis par Entrepreneur</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 150px;">Dessins - R√©f√©rences</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 150px;">Gammes</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 120px;">CptrGrpGam</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 150px;">Poste Technique</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; min-width: 100px;">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="t55HistoriqueStandaloneTableBody">
                        <tr>
                            <td colspan="13" style="padding: 30px; text-align: center; color: #666; border: 1px solid #dee2e6;">
                                Aucun historique disponible. Cliquez sur "Upload Excel" ou "Ajouter Ligne" pour commencer.
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div id="t55HistoriquePagination"></div>
        </div>
    </div>
</div>

<div id="detail-t57" class="page">
            <div class="summary-container" style="max-width: 98%; padding: 20px;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333; flex: 1;">√âTABLIR LES BESOIN EN √âQUIPEMENTS DE TRAVAIL EN HAUTEUR</h2>
                    <button onclick="syncTravailHauteurFromIw37n()" style="padding: 10px 20px; background: #48bb78; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 10px;">
                        üîÑ Synchroniser avec IW37N
                    </button>
                    <button onclick="addTravailHauteur()" style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        ‚ûï Ajouter √âquipement
                    </button>
                </div>

                <!-- Section Tableau des √âquipements de Travail en Hauteur -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <div>
                            <h3 style="margin: 0 0 5px 0; color: #333;">üìã Liste des √âquipements de Travail en Hauteur</h3>
                            <p style="margin: 0; color: #666; font-size: 0.95em;">
                                Total: <strong><span id="travailHauteurCount">0</span></strong> √©quipement(s)
                            </p>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button onclick="exportTravailHauteurToExcel()" style="padding: 10px 20px; background: #4299e1; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                                üì• Exporter Excel
                            </button>
                        </div>
                    </div>
                    <!-- Limiter la hauteur pour ne pas prendre tout l'√©cran -->
                    <div style="overflow-x: auto; max-height: 400px; overflow-y: auto; border: 1px solid #e2e8f0; border-radius: 8px;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead style="position: sticky; top: 0; z-index: 10;">
                                <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 100px;">Ordre</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 300px;">D√©sign. Op√©r.</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 150px;">Poste technique</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 200px;">Commentaire</th>
                                </tr>
                            </thead>
                            <tbody id="travailHauteurTableBody">
                                <tr>
                                    <td colspan="4" style="padding: 30px; text-align: center; color: #666;">
                                        Aucun √©quipement de travail en hauteur enregistr√©. Cliquez sur "Synchroniser avec IW37N" pour charger les donn√©es.
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Section Tableau des Demandes Standard de Nacelles -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <div>
                            <h3 style="margin: 0 0 5px 0; color: #333;">üèóÔ∏è Demandes Standard de Nacelles</h3>
                            <p style="margin: 0; color: #666; font-size: 0.95em;">
                                Total: <strong><span id="nacellesCount">0</span></strong> demande(s)
                            </p>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button onclick="addNacelle()" style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                                ‚ûï Ajouter Nacelle
                            </button>
                            <button onclick="exportNacellesToExcel()" style="padding: 10px 20px; background: #ff9800; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                                üì• Exporter Excel
                            </button>
                        </div>
                    </div>
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); color: white;">
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 200px;">√âquipement mobile l√©ger</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; min-width: 80px;">Quantit√©</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 150px;">Date de d√©but</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 150px;">Date de fin</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 250px;">Justification</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 300px;">D√©crire travail √† ex√©cuter</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; min-width: 100px;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="nacellesTableBody">
                                <tr>
                                    <td colspan="7" style="padding: 30px; text-align: center; color: #666;">
                                        Aucune demande de nacelle enregistr√©e. Cliquez sur "‚ûï Ajouter Nacelle" pour cr√©er une nouvelle demande.
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t58" class="page">
            <div class="summary-container" style="max-width: 98%; padding: 20px;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333; flex: 1;">PLANIFIER LES RENCONTRES DE PR√âPARATION ARR√äT HEBDO</h2>
                </div>

                <!-- Barre d'actions globales -->
                <div style="background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px; display: flex; gap: 10px; align-items: center;">
                    <button onclick="genererRencontresHebdoAuto()"
                            style="padding: 10px 20px; background: linear-gradient(145deg, #667eea, #764ba2); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; box-shadow: 0 2px 4px rgba(102, 126, 234, 0.3);">
                        üîÑ G√©n√©rer Calendrier Auto
                    </button>
                    <button onclick="addNewRencontreHebdo()"
                            style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        ‚ûï Nouvelle Rencontre
                    </button>
                    <button onclick="exportRencontreHebdoToExcel()"
                            style="padding: 10px 20px; background: #ff9800; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        üìÑ Exporter Excel
                    </button>
                    <span style="margin-left: auto; color: #666; font-size: 0.9em;">üí° G√©rez vos rencontres hebdomadaires de pr√©paration d'arr√™t</span>
                </div>

                <div style="display: grid; grid-template-columns: 250px 1fr; gap: 20px;">
                    <!-- Sidebar: Liste des rencontres -->
                    <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); height: fit-content;">
                        <h3 style="color: #667eea; margin: 0 0 15px 0;">üìö Mes Rencontres</h3>
                        <div id="rencontresHebdoListContainer">
                            <!-- Liste g√©n√©r√©e par JS -->
                        </div>
                    </div>

                    <!-- Contenu principal -->
                    <div style="display: flex; flex-direction: column; gap: 20px;">

                        <!-- En-t√™te de la rencontre s√©lectionn√©e -->
                        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); color: white;">
                            <div style="display: flex; align-items: center; gap: 15px;">
                                <div style="font-size: 2em;">üìã</div>
                                <div style="flex: 1;">
                                    <div style="font-size: 0.85em; opacity: 0.9; margin-bottom: 5px;">Rencontre en cours d'√©dition</div>
                                    <input type="text" id="hebdoRencontreTitre"
                                           placeholder="Nom de la rencontre"
                                           onchange="window.rencontresHebdoActions.updateRencontreTitre(this.value)"
                                           style="width: 100%; padding: 10px; border: none; border-radius: 5px; font-size: 1.2em; font-weight: bold; background: rgba(255,255,255,0.95); color: #333;">
                                </div>
                            </div>
                        </div>

                        <!-- Section Informations de base -->
                        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                <h3 style="color: #667eea; margin: 0;">‚ÑπÔ∏è Informations de base</h3>
                                <button onclick="window.rencontresHebdoActions.toggleRencontreCompletee()"
                                        id="toggleCompleteeBtn"
                                        style="padding: 10px 20px; background: #10b981; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; box-shadow: 0 2px 4px rgba(16, 185, 129, 0.3);">
                                    ‚úÖ Marquer comme compl√©t√©e
                                </button>
                            </div>

                            <div style="margin-bottom: 15px;">
                                <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">Date de la rencontre:</label>
                                <input type="date" id="hebdoDateRencontre"
                                       onchange="window.rencontresHebdoActions.updateRencontreField('dateRencontre', this.value)"
                                       style="padding: 8px; border: 1px solid #ced4da; border-radius: 4px; width: 200px;">
                            </div>

                            <div style="margin-bottom: 15px;">
                                <label style="display: block; font-weight: bold; margin-bottom: 5px; color: #333;">Participants:</label>
                                <input type="text" id="hebdoParticipants"
                                       onchange="window.rencontresHebdoActions.updateRencontreField('participants', this.value)"
                                       placeholder="Ex: Jean Dupont, Marie Martin, etc."
                                       style="width: 100%; padding: 8px; border: 1px solid #ced4da; border-radius: 4px;">
                            </div>
                        </div>

                        <!-- Section Ordre du jour -->
                        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h3 style="color: #667eea; margin-bottom: 15px;">üìù Ordre du jour</h3>
                            <textarea id="hebdoOrdreJour"
                                      onchange="window.rencontresHebdoActions.updateRencontreField('ordreJour', this.value)"
                                      rows="6"
                                      placeholder="Saisir l'ordre du jour de la rencontre..."
                                      style="width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 4px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; resize: vertical;"></textarea>
                        </div>

                        <!-- Section D√©cisions et notes -->
                        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h3 style="color: #667eea; margin-bottom: 15px;">‚úÖ D√©cisions et notes importantes</h3>
                            <textarea id="hebdoDecisions"
                                      onchange="window.rencontresHebdoActions.updateRencontreField('decisions', this.value)"
                                      rows="8"
                                      placeholder="Saisir les d√©cisions prises et notes importantes de la rencontre..."
                                      style="width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 4px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; resize: vertical;"></textarea>
                        </div>

                        <!-- Section Actions de suivi -->
                        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h3 style="color: #667eea; margin-bottom: 15px;">üéØ Actions de suivi</h3>

                            <div style="margin-bottom: 15px;">
                                <button onclick="window.rencontresHebdoActions.addActionSuivi()"
                                        style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                                    ‚ûï Ajouter une Action
                                </button>
                            </div>

                            <div style="overflow-x: auto;">
                                <table style="width: 100%; border-collapse: collapse; font-size: 0.9em;">
                                    <thead>
                                        <tr style="background: #f8f9fa; border-bottom: 2px solid #dee2e6;">
                                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 250px;">Description</th>
                                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 150px;">Responsable</th>
                                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 120px;">√âch√©ance</th>
                                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 120px;">Statut</th>
                                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; white-space: nowrap;">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="hebdoActionsTableBody">
                                        <tr>
                                            <td colspan="5" style="padding: 30px; text-align: center; color: #666;">
                                                Aucune action de suivi. Cliquez sur "Ajouter une Action" pour commencer.
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Section Documents -->
                        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <h3 style="color: #667eea; margin-bottom: 15px;">üìé Documents et pi√®ces jointes</h3>

                            <div style="margin-bottom: 15px;">
                                <button onclick="window.rencontresHebdoActions.addDocument()"
                                        style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                                    ‚ûï Ajouter un Document
                                </button>
                            </div>

                            <div id="hebdoDocumentsList" style="display: flex; flex-direction: column; gap: 10px;">
                                <p style="color: #666; text-align: center; padding: 20px;">Aucun document ajout√©.</p>
                            </div>
                        </div>

                    </div> <!-- Fin contenu principal -->
                </div> <!-- Fin grid -->
            </div> <!-- Fin summary-container -->
        </div> <!-- Fin detail-t58 -->

<div id="detail-t62" class="page">
            <div class="summary-container">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">√âVALUER BESOIN √âLECTRIQUES ARR√äT (PRISE DE SOUDURE)</h2>
                </div>
                <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <p style="color: #000000; font-size: 1.1em;">D√©tails de la t√¢che √† venir...</p>
                </div>
            </div>
        </div>

<div id="detail-t63" class="page">
            <div class="summary-container" style="max-width: 98%; padding: 20px;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333; flex: 1;">ZONES ENTREPOSAGES & PLAN DE LOCALISATION</h2>
                </div>

                <!-- Section Import de Plan -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">üñºÔ∏è Importer un Plan</h3>
                    <div style="margin-bottom: 15px; display: flex; gap: 10px;">
                        <input type="file" id="zonesPlanUpload" accept="image/*" style="display: none;" onchange="window.zonesPlanEditor.loadPlan(event)">
                        <button onclick="document.getElementById('zonesPlanUpload').click()"
                                style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            üìÇ Charger un Plan
                        </button>
                        <button onclick="window.zonesPlanEditor.clearPlan()"
                                style="padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            üóëÔ∏è Effacer le Plan
                        </button>
                        <button onclick="window.zonesPlanEditor.savePlan()"
                                style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            üíæ Sauvegarder
                        </button>
                        <button onclick="window.zonesPlanEditor.exportToPDF()"
                                style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            üìÑ Exporter PDF
                        </button>
                    </div>
                    <p style="color: #666; font-size: 0.9em; margin: 0;">Formats support√©s: JPG, PNG, GIF. Importez un plan puis utilisez les outils ci-dessous pour dessiner des zones.</p>
                </div>

                <!-- Outils de Dessin -->
                <div style="background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">üõ†Ô∏è Outils de Dessin</h3>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button onclick="window.zonesPlanEditor.setTool('select')" id="tool-select"
                                style="padding: 8px 16px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                            ‚úã S√©lectionner
                        </button>
                        <button onclick="window.zonesPlanEditor.setTool('rectangle')" id="tool-rectangle"
                                style="padding: 8px 16px; background: #f0f0f0; color: #333; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                            ‚¨ú Rectangle
                        </button>
                        <button onclick="window.zonesPlanEditor.setTool('circle')" id="tool-circle"
                                style="padding: 8px 16px; background: #f0f0f0; color: #333; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                            ‚≠ï Cercle
                        </button>
                        <button onclick="window.zonesPlanEditor.setTool('text')" id="tool-text"
                                style="padding: 8px 16px; background: #f0f0f0; color: #333; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                            üìù Texte
                        </button>
                        <button onclick="window.zonesPlanEditor.deleteSelected()"
                                style="padding: 8px 16px; background: #dc3545; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                            üóëÔ∏è Supprimer S√©lection
                        </button>
                        <div style="display: flex; align-items: center; gap: 8px; margin-left: 20px;">
                            <label style="font-weight: 600; color: #555;">Couleur:</label>
                            <input type="color" id="zone-color" value="#ff0000" onchange="window.zonesPlanEditor.setColor(this.value)"
                                   style="width: 50px; height: 35px; border: none; border-radius: 4px; cursor: pointer;">
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <label style="font-weight: 600; color: #555;">√âpaisseur:</label>
                            <input type="range" id="zone-thickness" min="1" max="10" value="3" onchange="window.zonesPlanEditor.setThickness(this.value)"
                                   style="width: 100px;">
                            <span id="thickness-value" style="font-weight: 600; color: #555;">3</span>
                        </div>
                    </div>
                </div>

                <!-- Canvas de Dessin -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <div style="position: relative; border: 2px solid #dee2e6; border-radius: 8px; overflow: hidden; background: #f8f9fa;">
                        <canvas id="zonesPlanCanvas" width="1200" height="800" style="display: block; cursor: crosshair; max-width: 100%;"></canvas>
                        <div id="canvasPlaceholder" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: #999; pointer-events: none;">
                            <div style="font-size: 3em; margin-bottom: 10px;">üìã</div>
                            <div style="font-size: 1.2em; font-weight: 600;">Aucun plan charg√©</div>
                            <div style="font-size: 0.9em; margin-top: 5px;">Cliquez sur "Charger un Plan" pour commencer</div>
                        </div>
                    </div>
                </div>

                <!-- Liste des Zones Dessin√©es -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="color: #667eea; margin-bottom: 15px;">üìã Zones Dessin√©es (<span id="zonesDrawnCount">0</span>)</h3>
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left;">Type</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left;">Commentaire</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Couleur</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="zonesDrawnTableBody">
                                <tr>
                                    <td colspan="4" style="padding: 30px; text-align: center; color: #666;">
                                        Aucune zone dessin√©e. Utilisez les outils ci-dessus pour dessiner sur le plan.
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t64" class="page">
            <div class="summary-container" style="max-width: 98%; padding: 20px;">
                <!-- En-t√™te -->
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 25px;">
                    <div style="display: flex; align-items: center;">
                        <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                        <h2 style="margin: 0; color: #333;">üìã REVISER PROTOCOLE D'ARR√äT ET DRAINAGE</h2>
                    </div>
                    <div style="display: flex; gap: 12px;">
                        <button onclick="window.protocoleGantt.addNewEtape()"
                                style="padding: 10px 20px; background: #10b981; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 500; display: flex; align-items: center; gap: 8px;">
                            ‚ûï Nouvelle √©tape
                        </button>
                        <button onclick="window.protocoleGantt.genererExemples()"
                                style="padding: 10px 20px; background: #f59e0b; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 500; display: flex; align-items: center; gap: 8px;">
                            üîÑ G√©n√©rer exemples
                        </button>
                        <button onclick="window.protocoleGantt.exportToPDF()"
                                style="padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 500; display: flex; align-items: center; gap: 8px;">
                            üìÑ Export PDF
                        </button>
                    </div>
                </div>

                <!-- Info sur le Gantt -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 10px; margin-bottom: 20px; color: white;">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 12px;">
                        <span style="font-size: 32px;">üìä</span>
                        <div>
                            <h3 style="margin: 0 0 5px 0; font-size: 18px;">Diagramme de Gantt du Protocole d'Arr√™t</h3>
                            <p style="margin: 0; opacity: 0.9; font-size: 14px;">
                                Planifiez et visualisez les √©tapes du protocole d'arr√™t et drainage avec pr√©cision.
                            </p>
                        </div>
                    </div>
                    <div style="display: flex; gap: 20px; font-size: 13px; margin-top: 15px;">
                        <span>‚úèÔ∏è Cliquez sur une barre pour √©diter</span>
                        <span>üñ±Ô∏è Glissez-d√©posez pour d√©placer</span>
                        <span>üìÖ Visualisation par jour</span>
                    </div>
                </div>

                <!-- L√©gende des statuts -->
                <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 20px; display: flex; gap: 25px; align-items: center; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                    <span style="font-weight: 600; color: #334155;">L√©gende :</span>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 16px; height: 16px; background: #94a3b8; border-radius: 4px;"></div>
                        <span style="color: #64748b; font-size: 14px;">Non d√©marr√©</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 16px; height: 16px; background: #3b82f6; border-radius: 4px;"></div>
                        <span style="color: #64748b; font-size: 14px;">En cours</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 16px; height: 16px; background: #10b981; border-radius: 4px;"></div>
                        <span style="color: #64748b; font-size: 14px;">Termin√©</span>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <div style="width: 16px; height: 16px; background: #ef4444; border-radius: 4px;"></div>
                        <span style="color: #64748b; font-size: 14px;">En retard</span>
                    </div>
                </div>

                <!-- Container du Gantt -->
                <div id="ganttContainer" style="min-height: 400px; background: #f8fafc; border-radius: 10px; padding: 20px;">
                    <div style="text-align: center; padding: 60px; color: #94a3b8;">
                        <div style="font-size: 48px; margin-bottom: 15px;">‚è≥</div>
                        <p>Chargement du diagramme de Gantt...</p>
                    </div>
                </div>

                <!-- Instructions -->
                <div style="background: #f0f9ff; border-left: 4px solid #3b82f6; padding: 15px 20px; margin-top: 20px; border-radius: 6px;">
                    <h4 style="margin: 0 0 10px 0; color: #1e40af; font-size: 14px;">üí° Instructions</h4>
                    <ul style="margin: 0; padding-left: 20px; color: #1e40af; font-size: 13px; line-height: 1.6;">
                        <li>Cr√©ez des √©tapes en cliquant sur "‚ûï Nouvelle √©tape"</li>
                        <li>√âditez une √©tape en cliquant sur le bouton ‚úèÔ∏è ou directement sur la barre du Gantt</li>
                        <li>D√©placez les √©tapes dans le temps en glissant-d√©posant les barres</li>
                        <li>D√©finissez les d√©pendances entre les √©tapes pour respecter l'ordre des op√©rations</li>
                        <li>Les √©tapes en retard apparaissent automatiquement en rouge</li>
                    </ul>
                </div>
            </div>
        </div>

<div id="detail-t65" class="page">
            <div class="summary-container" style="max-width: 98%; padding: 20px;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333; flex: 1;">DEMANDER PLAN DE LEVAGE POUR LES LEVAGES IMPORTANTS</h2>
                </div>

                <!-- Barre d'actions -->
                <div style="background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px; display: flex; gap: 10px; align-items: center;">
                    <button onclick="window.planLevageActions.addLevage()"
                            style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        ‚ûï Ajouter un Levage
                    </button>
                    <button onclick="window.planLevageActions.exportSelectedToPDF()"
                            style="padding: 10px 20px; background: #ff9800; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        üìÑ Exporter S√©lection en PDF
                    </button>
                    <button onclick="window.planLevageActions.exportAllToPDF()"
                            style="padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        üìë Exporter Tout en PDF
                    </button>
                    <button onclick="window.planLevageActions.exportToExcel()"
                            style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        üì• Exporter Excel
                    </button>
                    <span style="margin-left: auto; color: #666; font-size: 0.9em;">
                        Total: <strong><span id="planLevageCount">0</span></strong> levage(s)
                    </span>
                </div>

                <!-- Tableau des Levages -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="color: #667eea; margin-bottom: 15px;">üìã Liste des Levages Importants</h3>

                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; width: 50px;">
                                        <input type="checkbox" id="selectAllLevages" onchange="window.planLevageActions.toggleSelectAll(this.checked)"
                                               style="width: 18px; height: 18px; cursor: pointer;">
                                    </th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 120px;">Ordre</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 250px;">√âquipement</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 200px;">Commentaire</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 250px;">Documents</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; min-width: 100px;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="planLevageTableBody">
                                <tr>
                                    <td colspan="6" style="padding: 30px; text-align: center; color: #666;">
                                        Aucun levage enregistr√©. Cliquez sur "Ajouter un Levage" pour commencer.
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t66" class="page">
            <div class="summary-container">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">VALIDER AVEC MAGASIN CAPACIT√â DE TRAITEMENTS DES LOTS</h2>
                </div>
                <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <p style="color: #000000; font-size: 1.1em;">D√©tails de la t√¢che √† venir...</p>
                </div>
            </div>
        </div>

<div id="detail-t67" class="page">
            <div class="summary-container">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">FOURNIR LA LISTE DES GROSSE PI√àCE AU MAGASIN</h2>
                </div>
                <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <p style="color: #000000; font-size: 1.1em;">D√©tails de la t√¢che √† venir...</p>
                </div>
            </div>
        </div>

<div id="detail-t68" class="page">
            <div class="summary-container" style="max-width: 98%; padding: 20px;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333; flex: 1;">√âTABLIR LES BESOINS DE NETTOYAGE POUR CHACUNE DES JOBS</h2>
                </div>

                <!-- Barre d'actions -->
                <div style="background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px; display: flex; gap: 10px; align-items: center;">
                    <button onclick="window.besoinsNettoyageActions.renderBesoinsNettoyageTable()"
                            style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        üîÑ Actualiser
                    </button>
                    <button onclick="window.besoinsNettoyageActions.exportToExcel()"
                            style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        üì• Exporter Excel
                    </button>
                    <button onclick="window.besoinsNettoyageActions.exportToPDF()"
                            style="padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        üìÑ Exporter PDF
                    </button>
                    <span style="margin-left: auto; color: #666; font-size: 0.9em;">
                        Total: <strong><span id="besoinsNettoyageCount">0</span></strong> ligne(s)
                    </span>
                </div>

                <!-- L√©gende des postes -->
                <div style="background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 10px; font-size: 1em;">üìå Filtres appliqu√©s</h3>
                    <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="width: 20px; height: 20px; background: #3b82f6; border-radius: 4px;"></span>
                            <span style="color: #666;">ORTEC</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="width: 20px; height: 20px; background: #10b981; border-radius: 4px;"></span>
                            <span style="color: #666;">AEROVAC</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="width: 20px; height: 20px; background: #f59e0b; border-radius: 4px;"></span>
                            <span style="color: #666;">VEOLIA</span>
                        </div>
                    </div>
                    <p style="color: #666; font-size: 0.9em; margin-top: 10px; margin-bottom: 0;">
                        Ce tableau affiche toutes les op√©rations IW37N ayant pour <strong>Poste de travail op√©ration</strong> l'une des valeurs ci-dessus.
                    </p>
                </div>

                <!-- Tableau des besoins de nettoyage -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="color: #667eea; margin-bottom: 15px;">üìã Liste des Besoins de Nettoyage</h3>

                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; min-width: 120px;">Ordre</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 300px;">D√©signation Op√©ration</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; min-width: 100px;">Op√©ration</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; min-width: 150px;">Poste Travail</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 200px;">Poste Technique</th>
                                </tr>
                            </thead>
                            <tbody id="besoinsNettoyageTableBody">
                                <tr>
                                    <td colspan="5" style="padding: 30px; text-align: center; color: #666;">
                                        Chargement des donn√©es...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t69" class="page">
            <div class="summary-container">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">FOURNIR LES ECH√âANCIERS FINALES DES PROJETS (INCLUANT PLAN VPO)</h2>
                </div>
                <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <p style="color: #000000; font-size: 1.1em;">D√©tails de la t√¢che √† venir...</p>
                </div>
            </div>
        </div>

<div id="detail-t70" class="page">
            <div class="summary-container" style="max-width: 98%; padding: 20px;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333; flex: 1;">√âTABLIR LES BESOINS EN √âCHAFAUD</h2>
                    <button onclick="syncEquipementFromIw37n()" style="padding: 10px 20px; background: #48bb78; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 10px;">
                        üîÑ Synchroniser avec IW37N
                    </button>
                    <button onclick="addEquipementLevage()" style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        ‚ûï Ajouter √âquipement
                    </button>
                </div>

                <!-- Section Tableau des √âquipements -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <div>
                            <h3 style="margin: 0 0 5px 0; color: #333;">üìã Liste des √âquipements de Levage</h3>
                            <p style="margin: 0; color: #666; font-size: 0.95em;">
                                Total: <strong><span id="equipementLevageCount">0</span></strong> √©quipement(s) |
                                √âchafaudages: <strong><span id="echafaudageCount">0</span></strong> |
                                R√©currents: <strong><span id="recurrentCount">0</span></strong>
                            </p>
                            <div style="margin-top: 10px;">
                                <label style="font-size: 0.9em; color: #666; margin-right: 10px;">Filtrer:</label>
                                <select id="filterRecurrent" onchange="filterEquipementLevage()" style="padding: 5px 10px; border: 1px solid #ccc; border-radius: 6px;">
                                    <option value="">Tous</option>
                                    <option value="recurrent">R√©currents uniquement</option>
                                    <option value="non-recurrent">Non-r√©currents uniquement</option>
                                </select>
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button onclick="exportEquipementLevageToExcel()" style="padding: 10px 20px; background: #4299e1; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                                üì• Exporter Excel
                            </button>
                            <button onclick="exportEquipementLevageToPowerPoint()" style="padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                                üìÑ Exporter PDF
                            </button>
                        </div>
                    </div>
                    <div style="overflow-x: auto; max-height: 500px; overflow-y: auto;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead style="position: sticky; top: 0; z-index: 10;">
                                <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 100px;">Ordre</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; min-width: 80px;">Op√©</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 300px;">D√©sign. op√©r.</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; min-width: 100px;">R√©current</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 200px;">Commentaire</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; min-width: 180px;">Photo ou Documents</th>
                                </tr>
                            </thead>
                            <tbody id="equipementLevageTableBody">
                                <tr>
                                    <td colspan="6" style="padding: 30px; text-align: center; color: #666;">
                                        Aucun √©quipement de levage enregistr√©. Cliquez sur "Ajouter √âquipement" pour commencer.
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Section Fichiers -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0; color: #333;">üìé Documents et Fichiers</h3>
                        <button onclick="document.getElementById('equipementLevageFileInput').click()" style="padding: 10px 20px; background: #4299e1; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            üì§ Ajouter un Fichier
                        </button>
                        <input type="file" id="equipementLevageFileInput" style="display: none;" onchange="handleEquipementLevageFile(event)" multiple>
                    </div>
                    <div id="equipementLevageFilesList" style="display: grid; gap: 10px;">
                        <div style="padding: 20px; text-align: center; color: #666; border: 2px dashed #ddd; border-radius: 8px;">
                            Aucun fichier ajout√©. Cliquez sur "Ajouter un Fichier" pour t√©l√©verser des documents.
                        </div>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t71" class="page">
            <div class="summary-container">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">√âTABLIR CHEMIN CRITIQUE</h2>
                </div>

                <!-- Section Chemin Critique -->
                <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="color: #c5554a; margin-bottom: 15px;">üéØ Chemin Critique de l'Arr√™t</h3>

                    <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #c9941a;">
                        <p style="margin: 0; color: #856404;">
                            ‚ö†Ô∏è <strong>Important:</strong> Le chemin critique repr√©sente la s√©quence de t√¢ches qui d√©termine la dur√©e minimale de l'arr√™t.
                            Tout retard sur ces t√¢ches affecte directement la date de fin de l'arr√™t.
                        </p>
                    </div>

                    <button onclick="addCheminCritiqueTask()" style="padding: 10px 20px; background: #c5554a; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-bottom: 15px;">
                        ‚ûï Ajouter T√¢che au Chemin Critique
                    </button>

                    <div style="max-height: 500px; overflow-y: auto;">
                        <table class="summary-table" style="width: 100%;">
                            <thead>
                                <tr>
                                    <th style="width: 5%;">Ordre</th>
                                    <th style="width: 25%;">Nom de la T√¢che</th>
                                    <th style="width: 15%;">Responsable</th>
                                    <th style="width: 10%;">Dur√©e (h)</th>
                                    <th style="width: 12%;">Date D√©but</th>
                                    <th style="width: 12%;">Date Fin</th>
                                    <th style="width: 8%;">Marge</th>
                                    <th style="width: 8%;">Statut</th>
                                    <th style="width: 5%;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="cheminCritiqueTableBody">
                                <tr>
                                    <td colspan="9" style="text-align: center; color: #999; padding: 20px;">Aucune t√¢che sur le chemin critique</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Statistiques du Chemin Critique -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
                        <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 2em; font-weight: bold; color: #000000;" id="cheminCritiqueDureeTotal">0h</div>
                            <div style="color: #000000; margin-top: 5px;">Dur√©e Totale</div>
                        </div>
                        <div style="background: #fff3cd; padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 2em; font-weight: bold; color: #856404;" id="cheminCritiqueTachesEnRetard">0</div>
                            <div style="color: #000000; margin-top: 5px;">T√¢ches en Retard</div>
                        </div>
                        <div style="background: #d4edda; padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 2em; font-weight: bold; color: #155724;" id="cheminCritiqueTachesCompletes">0</div>
                            <div style="color: #000000; margin-top: 5px;">T√¢ches Compl√©t√©es</div>
                        </div>
                        <div style="background: #f8d7da; padding: 15px; border-radius: 8px; text-align: center;">
                            <div style="font-size: 2em; font-weight: bold; color: #721c24;" id="cheminCritiqueMargeMin">0h</div>
                            <div style="color: #000000; margin-top: 5px;">Marge Minimale</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t72" class="page">
            <div class="summary-container" style="max-width: 100%;">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center;">
                        <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                        <h2 style="margin: 0; color: #333;">√âTABLIR LE PROCESSUS DE SUIVI DE CO√õT</h2>
                    </div>
                    <button onclick="generateT72Report()" style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        üìä G√©n√©rer un Rapport
                    </button>
                </div>

                <!-- Alert Section pour rappel d'enregistrement -->
                <div style="background: #fff3cd; border-left: 5px solid #ffc107; padding: 15px; border-radius: 8px; margin-bottom: 20px; display: flex; align-items: center; gap: 15px;">
                    <div style="font-size: 2em;">‚ö†Ô∏è</div>
                    <div>
                        <strong style="color: #856404;">Important :</strong>
                        <span style="color: #856404;"> N'oubliez pas d'enregistrer le Budget Total dans les Param√®tres de l'Arr√™t Annuel (‚öôÔ∏è) pour synchroniser avec le serveur.</span>
                    </div>
                </div>

                <!-- Budget Global Section - Vue d'ensemble -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); margin-bottom: 25px; color: white;">
                    <h3 style="margin: 0 0 20px 0; color: white; font-size: 1.4em; display: flex; align-items: center; gap: 10px;">
                        <span>üí∞</span> BILAN BUDG√âTAIRE GLOBAL
                    </h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px;">
                        <!-- Budget Total des Param√®tres -->
                        <div style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); padding: 20px; border-radius: 10px; border: 2px solid rgba(255, 255, 255, 0.3);">
                            <div style="font-size: 0.9em; opacity: 0.9; margin-bottom: 8px;">Budget Total Autoris√©</div>
                            <div style="font-size: 2.2em; font-weight: bold;" id="t72GlobalBudgetTotal">0 ‚Ç¨</div>
                            <div style="font-size: 0.8em; opacity: 0.8; margin-top: 5px;">(Param√®tres Arr√™t)</div>
                        </div>

                        <!-- Budget Pr√©visionnel T72 -->
                        <div style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); padding: 20px; border-radius: 10px; border: 2px solid rgba(255, 255, 255, 0.3);">
                            <div style="font-size: 0.9em; opacity: 0.9; margin-bottom: 8px;">Budget Pr√©visionnel</div>
                            <div style="font-size: 2.2em; font-weight: bold;" id="t72GlobalBudgetPrevu">0 ‚Ç¨</div>
                            <div style="font-size: 0.8em; opacity: 0.8; margin-top: 5px;">(Planifi√© T72)</div>
                        </div>

                        <!-- D√©penses R√©elles -->
                        <div style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); padding: 20px; border-radius: 10px; border: 2px solid rgba(255, 255, 255, 0.3);">
                            <div style="font-size: 0.9em; opacity: 0.9; margin-bottom: 8px;">D√©penses R√©elles</div>
                            <div style="font-size: 2.2em; font-weight: bold;" id="t72GlobalActualTotal">0 ‚Ç¨</div>
                            <div style="font-size: 0.8em; opacity: 0.8; margin-top: 5px;" id="t72GlobalPercentage">0% utilis√©</div>
                        </div>

                        <!-- Solde Disponible -->
                        <div style="background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); padding: 20px; border-radius: 10px; border: 2px solid rgba(255, 255, 255, 0.3);">
                            <div style="font-size: 0.9em; opacity: 0.9; margin-bottom: 8px;">Solde Disponible</div>
                            <div style="font-size: 2.2em; font-weight: bold;" id="t72GlobalRemaining">0 ‚Ç¨</div>
                            <div style="font-size: 0.8em; opacity: 0.8; margin-top: 5px;" id="t72GlobalStatus">√Ä suivre</div>
                        </div>
                    </div>
                </div>

                <!-- Synth√®se par Cat√©gorie -->
                <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <h3 style="margin: 0 0 20px 0; color: #333; font-size: 1.3em;">üìä Synth√®se par Cat√©gorie</h3>
                    <div id="t72SummaryContainer" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <!-- Summary cards will be rendered here -->
                    </div>
                </div>

                <!-- Section Budget et D√©penses -->
                <div style="display: grid; grid-template-columns: 400px 1fr; gap: 20px;">

                    <!-- Budget Pr√©visionnel -->
                    <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); height: fit-content;">
                        <h3 style="margin-top: 0; color: #333; border-bottom: 3px solid #667eea; padding-bottom: 10px;">üíµ Budget Pr√©visionnel</h3>
                        <div style="display: grid; gap: 15px;">
                            <div>
                                <label style="font-weight: bold; display: block; margin-bottom: 5px; color: #555;">Externes (‚Ç¨):</label>
                                <input type="number" id="budgetExterne" class="budget-input" onchange="updateT72Budget()" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 6px; font-size: 1em;">
                            </div>
                            <div>
                                <label style="font-weight: bold; display: block; margin-bottom: 5px; color: #555;">Pi√®ces (‚Ç¨):</label>
                                <input type="number" id="budgetPieces" class="budget-input" onchange="updateT72Budget()" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 6px; font-size: 1em;">
                            </div>
                            <div>
                                <label style="font-weight: bold; display: block; margin-bottom: 5px; color: #555;">Main d'≈ìuvre (‚Ç¨):</label>
                                <input type="number" id="budgetMainDoeuvre" class="budget-input" onchange="updateT72Budget()" style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 6px; font-size: 1em;">
                            </div>
                            <div style="background: #e8eaf6; padding: 15px; border-radius: 8px; margin-top: 10px; border-left: 4px solid #667eea;">
                                <div style="font-size: 0.9em; color: #555; margin-bottom: 5px;">TOTAL BUDGET PR√âVU</div>
                                <div style="font-weight: bold; font-size: 1.8em; color: #667eea;">
                                    <span id="budgetTotal">0.00</span> ‚Ç¨
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Co√ªts R√©els -->
                    <div>
                        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                <h4 style="margin: 0; color: #c5554a;">üíº Co√ªts R√©els - Externes</h4>
                                <button onclick="addT72Actual('externe')" class="add-cost-btn" style="padding: 8px 16px; background: #4a7c59; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">‚ûï Ajouter</button>
                            </div>
                            <div class="summary-table-wrapper" style="max-height: 200px; overflow-y: auto;"><table class="summary-table"><thead><tr><th>Description</th><th>Montant (‚Ç¨)</th><th>Action</th></tr></thead><tbody id="actualExterneTableBody"></tbody></table></div>
                        </div>
                        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                <h4 style="margin: 0; color: #c5554a;">üîß Co√ªts R√©els - Pi√®ces</h4>
                                <button onclick="addT72Actual('pieces')" class="add-cost-btn" style="padding: 8px 16px; background: #4a7c59; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">‚ûï Ajouter</button>
                            </div>
                            <div class="summary-table-wrapper" style="max-height: 200px; overflow-y: auto;"><table class="summary-table"><thead><tr><th>Description</th><th>Montant (‚Ç¨)</th><th>Action</th></tr></thead><tbody id="actualPiecesTableBody"></tbody></table></div>
                        </div>
                        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                <h4 style="margin: 0; color: #c5554a;">üë∑ Co√ªts R√©els - Main d'≈ìuvre</h4>
                                <button onclick="addT72Actual('mainDoeuvre')" class="add-cost-btn" style="padding: 8px 16px; background: #4a7c59; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">‚ûï Ajouter</button>
                            </div>
                            <div class="summary-table-wrapper" style="max-height: 200px; overflow-y: auto;"><table class="summary-table"><thead><tr><th>Description</th><th>Montant (‚Ç¨)</th><th>Action</th></tr></thead><tbody id="actualMainDoeuvreTableBody"></tbody></table></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t75" class="page">
            <div class="summary-container" style="max-width: 95%;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">VALIDATION LIVRAISON DES OSCILLATEURS</h2>
                </div>

                <!-- Section Informations G√©n√©rales -->
                <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-top: 0;">üì¶ Informations de Livraison</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                        <div>
                            <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">Date de livraison pr√©vue:</label>
                            <input type="date" id="t75-dateLivraison" onchange="saveT75Data()" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">Fournisseur:</label>
                            <input type="text" id="t75-fournisseur" placeholder="Nom du fournisseur" onchange="saveT75Data()" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">Nombre d'oscillateurs:</label>
                            <input type="number" id="t75-quantite" placeholder="Ex: 4" onchange="saveT75Data()" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">Statut:</label>
                            <select id="t75-statut" onchange="saveT75Data()" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <option value="">-- S√©lectionner --</option>
                                <option value="En attente">En attente</option>
                                <option value="Confirm√©">Confirm√©</option>
                                <option value="Livr√©">Livr√©</option>
                                <option value="Valid√©">Valid√©</option>
                                <option value="Probl√®me">Probl√®me</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Section Comptes-Rendus de R√©union -->
                <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="color: #667eea; margin: 0;">üìù Comptes-Rendus de R√©union</h3>
                        <button onclick="showAddReunionT75()" style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            ‚ûï Nouveau Compte-Rendu
                        </button>
                    </div>

                    <!-- Formulaire d'ajout de compte-rendu (cach√© par d√©faut) -->
                    <div id="t75-reunionForm" style="display: none; background: #e3f2fd; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                        <h4 style="margin-top: 0; color: #000000;">‚úèÔ∏è Nouveau Compte-Rendu</h4>

                        <div style="display: grid; gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">Date de la r√©union:</label>
                                <input type="date" id="t75-reunionDate" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                            </div>

                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">Sujet / Titre:</label>
                                <input type="text" id="t75-reunionSujet" placeholder="Ex: Validation inspection oscillateurs" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <div style="font-size: 11px; color: #666; margin-top: 5px;">üí° Titre court d√©crivant le sujet principal de la r√©union</div>
                            </div>

                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">Participants:</label>
                                <input type="text" id="t75-reunionParticipants" placeholder="Ex: Jean Tremblay, Marie Dubois, √âquipe Entretien" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <div style="font-size: 11px; color: #666; margin-top: 5px;">üí° Liste des personnes pr√©sentes</div>
                            </div>

                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">Commentaires / Notes:</label>
                                <textarea id="t75-reunionCommentaires" rows="5" placeholder="Ex: Discussion sur les sp√©cifications techniques, validation des dimensions, points √† v√©rifier √† la r√©ception..." style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-family: Arial, sans-serif; resize: vertical;"></textarea>
                                <div style="font-size: 11px; color: #666; margin-top: 5px;">üí° Points discut√©s, d√©cisions prises, actions √† suivre</div>
                            </div>

                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">Actions √† suivre:</label>
                                <textarea id="t75-reunionActions" rows="3" placeholder="Ex: - V√©rifier les certificats de conformit√©&#10;- Planifier l'inspection visuelle&#10;- Contacter le fournisseur pour confirmer" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-family: Arial, sans-serif; resize: vertical;"></textarea>
                                <div style="font-size: 11px; color: #666; margin-top: 5px;">üí° Liste des actions √† entreprendre suite √† la r√©union</div>
                            </div>
                        </div>

                        <div style="display: flex; gap: 10px; justify-content: flex-end;">
                            <button onclick="cancelReunionT75()" style="padding: 10px 20px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                                ‚ùå Annuler
                            </button>
                            <button onclick="saveReunionT75()" style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                                üíæ Sauvegarder
                            </button>
                        </div>
                    </div>

                    <!-- Liste des comptes-rendus -->
                    <div id="t75-reunionsList">
                        <p style="text-align: center; color: #999; padding: 20px;">Aucun compte-rendu enregistr√©</p>
                    </div>
                </div>

                <!-- Section Notes G√©n√©rales -->
                <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="color: #667eea; margin-top: 0;">üìã Notes G√©n√©rales</h3>
                    <textarea id="t75-notes" rows="5" placeholder="Notes additionnelles sur la validation et la livraison des oscillateurs..." onchange="saveT75Data()" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-family: Arial, sans-serif; resize: vertical;"></textarea>
                </div>
            </div>
        </div>

<div id="detail-t79" class="page">
            <div class="summary-container" style="max-width: 98%; padding: 20px;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333; flex: 1;">R√âSERVATION √âQUIPEMENTS EN LOCATION (EX: ROULOTTES, G√âN√âRATRICE, ETC)</h2>
                </div>

                <!-- Tableau des √âquipements en Location -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h3 style="color: #667eea; margin: 0;">üìã Liste des √âquipements R√©serv√©s (<span id="equipLocationCount">0</span>)</h3>
                        <div style="display: flex; gap: 10px;">
                            <button onclick="window.equipLocationActions.addEquipement()"
                                    style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                                ‚ûï Ajouter √âquipement
                            </button>
                            <button onclick="window.equipLocationActions.exportToExcel()"
                                    style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                                üì• Exporter Excel
                            </button>
                        </div>
                    </div>

                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 200px;">Entrepreneur</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; min-width: 150px;">Nombre de Roulottes</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 180px;">Dimension de la Roulotte</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 250px;">Commentaire</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; min-width: 100px;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="equipLocationTableBody">
                                <tr>
                                    <td colspan="5" style="padding: 30px; text-align: center; color: #666;">
                                        Aucun √©quipement enregistr√©. Cliquez sur "Ajouter √âquipement" pour commencer.
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Section Import de Plan -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">üñºÔ∏è Importer un Plan de Localisation</h3>
                    <div style="margin-bottom: 15px; display: flex; gap: 10px;">
                        <input type="file" id="equipLocationPlanUpload" accept="image/*" style="display: none;" onchange="window.equipLocationPlanEditor.loadPlan(event)">
                        <button onclick="document.getElementById('equipLocationPlanUpload').click()"
                                style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            üìÇ Charger un Plan
                        </button>
                        <button onclick="window.equipLocationPlanEditor.clearPlan()"
                                style="padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            üóëÔ∏è Effacer le Plan
                        </button>
                        <button onclick="window.equipLocationPlanEditor.savePlan()"
                                style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            üíæ Sauvegarder
                        </button>
                        <button onclick="window.equipLocationPlanEditor.exportToPDF()"
                                style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            üìÑ Exporter PDF
                        </button>
                    </div>
                    <p style="color: #666; font-size: 0.9em; margin: 0;">Formats support√©s: JPG, PNG, GIF. Importez un plan puis utilisez les outils ci-dessous pour localiser vos √©quipements.</p>
                </div>

                <!-- Outils de Dessin -->
                <div style="background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">üõ†Ô∏è Outils de Dessin</h3>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button onclick="window.equipLocationPlanEditor.setTool('select')" id="equip-tool-select"
                                style="padding: 8px 16px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                            ‚úã S√©lectionner
                        </button>
                        <button onclick="window.equipLocationPlanEditor.setTool('rectangle')" id="equip-tool-rectangle"
                                style="padding: 8px 16px; background: #f0f0f0; color: #333; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                            ‚¨ú Rectangle
                        </button>
                        <button onclick="window.equipLocationPlanEditor.setTool('circle')" id="equip-tool-circle"
                                style="padding: 8px 16px; background: #f0f0f0; color: #333; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                            ‚≠ï Cercle
                        </button>
                        <button onclick="window.equipLocationPlanEditor.setTool('text')" id="equip-tool-text"
                                style="padding: 8px 16px; background: #f0f0f0; color: #333; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                            üìù Texte
                        </button>
                        <button onclick="window.equipLocationPlanEditor.deleteSelected()"
                                style="padding: 8px 16px; background: #dc3545; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600;">
                            üóëÔ∏è Supprimer S√©lection
                        </button>
                        <div style="display: flex; align-items: center; gap: 8px; margin-left: 20px;">
                            <label style="font-weight: 600; color: #555;">Couleur:</label>
                            <input type="color" id="equip-zone-color" value="#ff0000" onchange="window.equipLocationPlanEditor.setColor(this.value)"
                                   style="width: 50px; height: 35px; border: none; border-radius: 4px; cursor: pointer;">
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <label style="font-weight: 600; color: #555;">√âpaisseur:</label>
                            <input type="range" id="equip-zone-thickness" min="1" max="10" value="3" onchange="window.equipLocationPlanEditor.setThickness(this.value)"
                                   style="width: 100px;">
                            <span id="equip-thickness-value" style="font-weight: 600; color: #555;">3</span>
                        </div>
                    </div>
                </div>

                <!-- Canvas de Dessin -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <div style="position: relative; border: 2px solid #dee2e6; border-radius: 8px; overflow: hidden; background: #f8f9fa;">
                        <canvas id="equipLocationPlanCanvas" width="1200" height="800" style="display: block; cursor: crosshair; max-width: 100%;"></canvas>
                        <div id="equipCanvasPlaceholder" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: #999; pointer-events: none;">
                            <div style="font-size: 3em; margin-bottom: 10px;">üìã</div>
                            <div style="font-size: 1.2em; font-weight: 600;">Aucun plan charg√©</div>
                            <div style="font-size: 0.9em; margin-top: 5px;">Cliquez sur "Charger un Plan" pour commencer</div>
                        </div>
                    </div>
                </div>

                <!-- Liste des Zones Dessin√©es -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="color: #667eea; margin-bottom: 15px;">üìã Localisations Dessin√©es (<span id="equipZonesDrawnCount">0</span>)</h3>
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left;">Type</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left;">Commentaire</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Couleur</th>
                                    <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="equipZonesDrawnTableBody">
                                <tr>
                                    <td colspan="4" style="padding: 30px; text-align: center; color: #666;">
                                        Aucune localisation dessin√©e. Utilisez les outils ci-dessus pour dessiner sur le plan.
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t90" class="page">
            <div class="summary-container">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">COMMANDE DES CONSOMMABLES D'ARR√äT</h2>
                </div>
                <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0; color: #333;">Liste des Consommables</h3>
                        <div>
                            <button onclick="addConsommableRow()" style="padding: 10px 20px; background: #48bb78; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 10px;">‚ûï Ajouter</button>
                        </div>
                    </div>
                    <div class="summary-table-wrapper">
                        <table class="summary-table" id="consommablesTable">
                            <thead>
                                <tr>
                                    <th>Item</th>
                                    <th>Quantit√©</th>
                                    <th>Fournisseur</th>
                                    <th>Date de Commande</th>
                                    <th>Date de Livraison Pr√©vue</th>
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="consommablesTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t91" class="page">
            <div class="summary-container" style="max-width: 98%;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">FAIRE VISITE DES SOUMISSIONNAIRES ( CHANGEMENT DE CONVERTISSEUR)</h2>
                </div>

                <!-- Section Tableau des Visites -->
                <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="margin: 0; color: #667eea;">üìã Tableau de Suivi des Visites</h3>
                        <div>
                            <button onclick="syncT91Entrepreneurs()" style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; margin-right: 10px;">üîÑ Synchroniser depuis IW37N</button>
                            <button onclick="addT91Visite()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; margin-right: 10px;">‚ûï Ajouter Visite</button>
                            <button onclick="exportT91ToExcel()" style="padding: 10px 20px; background: #17a2b8; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">üì• Exporter vers Excel</button>
                        </div>
                    </div>

                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                    <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Entrepreneur</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Nbr Semaines</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Date Visite</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Statut</th>
                                    <th style="padding: 12px; text-align: center; border: 1px solid #ddd;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="t91TableBody">
                                <!-- Rows generated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Section Notes de Visite -->
                <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <h3 style="margin: 0 0 15px 0; color: #667eea;">üìù Notes de Visite</h3>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">S√©lectionner Entrepreneur:</label>
                        <select id="t91NotesEntrepreneur" onchange="loadT91Notes()" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 1em;">
                            <option value="">-- S√©lectionner un entrepreneur --</option>
                        </select>
                    </div>
                    <div id="t91NotesSection" style="display: none;">
                        <textarea id="t91NotesText" placeholder="Saisir vos notes de visite ici..." style="width: 100%; min-height: 200px; padding: 15px; border: 1px solid #ddd; border-radius: 6px; font-size: 1em; font-family: Arial, sans-serif; resize: vertical;"></textarea>
                        <button onclick="saveT91Notes()" style="margin-top: 10px; padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">üíæ Sauvegarder Notes</button>
                    </div>
                </div>

                <!-- Section Documents de Visite -->
                <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="margin: 0 0 15px 0; color: #667eea;">üìé Documents de Visite</h3>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">S√©lectionner Entrepreneur:</label>
                        <select id="t91DocsEntrepreneur" onchange="loadT91Documents()" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 1em;">
                            <option value="">-- S√©lectionner un entrepreneur --</option>
                        </select>
                    </div>
                    <div id="t91DocsSection" style="display: none;">
                        <button onclick="addT91Document()" style="margin-bottom: 15px; padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">‚ûï Ajouter Document</button>
                        <div id="t91DocumentsList"></div>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t93" class="page">
            <div class="summary-container">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">VALIDATION DE POINTS DE PURGES GAZ CO</h2>
                </div>
                <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <p style="color: #000000; font-size: 1.1em;">Validation et v√©rification des points de purges pour le gaz CO.</p>
                </div>
            </div>
        </div>

<div id="detail-t94" class="page">
            <div class="summary-container">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">RENCONTRE AVEC L'√âQUIPE DU GAZ CO ( POUR L'ARR√äT DU GAZ CO)</h2>
                </div>
                <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <p style="color: #000000; font-size: 1.1em;">Planification et coordination de la rencontre avec l'√©quipe responsable du gaz CO.</p>
                </div>
            </div>
        </div>

<div id="detail-t95" class="page">
            <div class="summary-container" style="max-width: 98%;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">√âTABLIR LES ZONES DE VERROUILLAGE</h2>
                </div>

                <!-- Section Tableau des Zones de Verrouillage -->
                <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="color: #667eea; margin: 0;">üìã Liste des Zones de Verrouillage</h3>
                        <button onclick="showAddZoneT95()" style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            ‚ûï Ajouter une Zone
                        </button>
                    </div>

                    <!-- Formulaire d'ajout de zone (cach√© par d√©faut) -->
                    <div id="t95-zoneForm" style="display: none; background: #e3f2fd; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                        <h4 style="margin-top: 0; color: #000000;">‚úèÔ∏è Nouvelle Zone de Verrouillage</h4>

                        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">Nom de la zone:</label>
                                <input type="text" id="t95-zoneNom" placeholder="Ex: Zone Convertisseur 1" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <div style="font-size: 11px; color: #666; margin-top: 5px;">üí° Nom descriptif de la zone</div>
                            </div>

                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">Commentaire / Description:</label>
                                <textarea id="t95-zoneCommentaire" rows="3" placeholder="Ex: Zone √©lectrique haute tension, acc√®s restreint, verrouillage obligatoire avant intervention..." style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-family: Arial, sans-serif; resize: vertical;"></textarea>
                                <div style="font-size: 11px; color: #666; margin-top: 5px;">üí° √âquipements concern√©s, proc√©dures sp√©ciales, niveau de danger</div>
                            </div>
                        </div>

                        <div style="display: flex; gap: 10px; justify-content: flex-end;">
                            <button onclick="cancelZoneT95()" style="padding: 10px 20px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                                ‚ùå Annuler
                            </button>
                            <button onclick="saveZoneT95()" style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                                üíæ Sauvegarder
                            </button>
                        </div>
                    </div>

                    <!-- Tableau des zones -->
                    <div id="t95-zonesTable" style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; background: white;">
                            <thead>
                                <tr style="background: #667eea; color: white;">
                                    <th style="padding: 12px; text-align: left; border: 1px solid #ddd; width: 50px;">#</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #ddd; width: 250px;">Nom de la Zone</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Commentaire / Description</th>
                                    <th style="padding: 12px; text-align: center; border: 1px solid #ddd; width: 100px;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="t95-zonesTableBody">
                                <tr>
                                    <td colspan="4" style="padding: 20px; text-align: center; color: #999;">Aucune zone de verrouillage d√©finie</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Section Upload et Placement sur Plan -->
                <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-top: 0;">üó∫Ô∏è √âtape 1 : Charger le Plan</h3>
                    <p style="color: #000000; margin-bottom: 15px;">Uploadez le plan de l'usine/chantier pour placer visuellement les zones de verrouillage.</p>

                    <div style="display: flex; gap: 15px; align-items: center;">
                        <input type="file" id="t95planUpload" accept="image/*" onchange="uploadT95Plan(event)"
                               style="padding: 10px; border: 1px solid #ddd; border-radius: 5px; flex: 1;">
                        <button onclick="clearT95Plan()" style="padding: 10px 20px; background: #c5554a; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                            üóëÔ∏è Effacer Plan
                        </button>
                    </div>
                </div>

                <!-- Zone de placement des zones sur le plan -->
                <div id="t95planContainer" style="display: none;">
                    <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h3 style="color: #667eea; margin: 0;">üó∫Ô∏è √âtape 2 : Placer les Zones sur le Plan</h3>
                            <div style="display: flex; gap: 10px;">
                                <button onclick="addZoneModeT95()" id="addZoneModeT95Btn" style="padding: 8px 15px; background: #4a7c59; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                                    ‚ûï Mode Placement
                                </button>
                                <button onclick="cancelZoneModeT95()" id="cancelZoneModeT95Btn" style="display: none; padding: 8px 15px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                                    ‚ùå Annuler Mode
                                </button>
                            </div>
                        </div>
                        <p style="color: #000000; margin-bottom: 15px;">Cliquez sur le plan pour placer une zone de verrouillage. Vous pourrez ensuite s√©lectionner quelle zone dans la liste.</p>

                        <div style="position: relative; border: 2px solid #ddd; border-radius: 8px; overflow: hidden; background: #f8f9fa; max-width: 100%;">
                            <canvas id="t95planCanvas" style="display: block; max-width: 100%; cursor: crosshair;"></canvas>
                        </div>
                    </div>

                    <!-- Liste des zones plac√©es sur le plan -->
                    <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <h3 style="color: #667eea; margin-top: 0;">üìç Zones Plac√©es sur le Plan</h3>
                        <div id="t95placedZonesList">
                            <p style="text-align: center; color: #999; padding: 20px;">Aucune zone plac√©e sur le plan</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t99" class="page">
            <div class="summary-container">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">R√âALISER LES AMDEC SUR LES T√ÇCHES CRITIQUES (ONGLET PL-10)</h2>
                </div>
                <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <p style="color: #000000; font-size: 1.1em;">R√©alisation des analyses AMDEC sur les t√¢ches critiques identifi√©es.</p>
                </div>
            </div>
        </div>

<div id="detail-t100" class="page">
            <div class="summary-container" style="max-width: 98%; padding: 20px;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333; flex: 1;">CONCEVOIR LE PLAN D'AM√âNAGEMENT (CHANTIER ET ROULOTTE)</h2>
                </div>

                <!-- Section Upload d'Images -->
                <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">üñºÔ∏è Plans d'Am√©nagement</h3>
                    <div style="margin-bottom: 15px;">
                        <input type="file" id="amenagementUploadPlan" accept="image/*" style="display: none;" onchange="handleAmenagementImageUpload(event)">
                        <button onclick="document.getElementById('amenagementUploadPlan').click()"
                                style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            ‚ûï Ajouter un Plan
                        </button>
                        <button onclick="exportAmenagementData()"
                                style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-left: 10px;">
                            üíæ Sauvegarder les Donn√©es
                        </button>
                    </div>
                    <p style="color: #000000; font-size: 0.9em; margin: 0;">Formats support√©s: JPG, PNG, GIF. Cliquez sur un plan pour ajouter des zones (chantier, roulottes, etc.).</p>
                </div>

                <!-- Liste des Plans -->
                <div id="amenagementPlansContainer"></div>
            </div>
        </div>

<div id="detail-t109" class="page">
            <div class="summary-container" style="max-width: 98%;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">R√âDACTION DES T√ÇCHES COGNIBOX</h2>
                </div>

                <!-- Tableau des t√¢ches Cognibox -->
                <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="color: #667eea; margin: 0;">üìã Liste des T√¢ches Cognibox</h3>
                        <button onclick="showAddTaskCognibox()" style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                            ‚ûï Ajouter une T√¢che
                        </button>
                    </div>

                    <!-- Formulaire d'ajout de t√¢che (cach√© par d√©faut) -->
                    <div id="cognibox-taskForm" style="display: none; background: #e3f2fd; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                        <h4 style="margin-top: 0; color: #000000;">‚úèÔ∏è Nouvelle T√¢che Cognibox</h4>

                        <div style="display: grid; gap: 15px; margin-bottom: 15px;">
                            <div style="display: grid; grid-template-columns: 1fr 2fr 1fr 1fr; gap: 15px;">
                                <div>
                                    <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">Externe:</label>
                                    <input type="text" id="cognibox-externe" placeholder="Ex: Entreprise ABC" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                    <div style="font-size: 11px; color: #666; margin-top: 5px;">üí° Nom de l'entreprise externe</div>
                                </div>

                                <div>
                                    <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">Num√©ro de la t√¢che:</label>
                                    <input type="text" id="cognibox-numero" placeholder="Ex: TASK-001" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                    <div style="font-size: 11px; color: #666; margin-top: 5px;">üí° Identifiant unique de la t√¢che</div>
                                </div>

                                <div>
                                    <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">Date de d√©but:</label>
                                    <input type="date" id="cognibox-dateDebut" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                </div>

                                <div>
                                    <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">Date de fin:</label>
                                    <input type="date" id="cognibox-dateFin" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                </div>
                            </div>

                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: bold; color: #333;">Commentaire:</label>
                                <textarea id="cognibox-commentaire" rows="3" placeholder="Ex: Travaux de maintenance sur les √©quipements √©lectriques..." style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-family: Arial, sans-serif; resize: vertical;"></textarea>
                                <div style="font-size: 11px; color: #666; margin-top: 5px;">üí° Description d√©taill√©e de la t√¢che, notes importantes</div>
                            </div>
                        </div>

                        <div style="display: flex; gap: 10px; justify-content: flex-end;">
                            <button onclick="cancelTaskCognibox()" style="padding: 10px 20px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                                ‚ùå Annuler
                            </button>
                            <button onclick="saveTaskCognibox()" style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                                üíæ Sauvegarder
                            </button>
                        </div>
                    </div>

                    <!-- Tableau -->
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse; background: white;">
                            <thead>
                                <tr style="background: #667eea; color: white;">
                                    <th style="padding: 12px; text-align: left; border: 1px solid #ddd; width: 50px;">#</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #ddd; width: 180px;">Externe</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #ddd; width: 150px;">Num√©ro de la T√¢che</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #ddd; width: 130px;">Date de D√©but</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #ddd; width: 130px;">Date de Fin</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Commentaire</th>
                                    <th style="padding: 12px; text-align: center; border: 1px solid #ddd; width: 100px;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="cognibox-tasksTableBody">
                                <tr>
                                    <td colspan="7" style="padding: 20px; text-align: center; color: #999;">Aucune t√¢che Cognibox enregistr√©e</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t110" class="page">
            <div class="summary-container" style="max-width: 98%;">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">D√âTERMINER L'EMPLACEMENT DES POCHES</h2>
                </div>

                <!-- Upload du plan -->
                <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                    <h3 style="color: #667eea; margin-top: 0;">üìÑ √âtape 1 : Charger le Plan</h3>
                    <p style="color: #000000; margin-bottom: 15px;">Uploadez le plan de l'usine/chantier pour placer les emplacements des poches.</p>

                    <div style="display: flex; gap: 15px; align-items: center;">
                        <input type="file" id="pochesplanUpload" accept="image/*" onchange="uploadPochesPlan(event)"
                               style="padding: 10px; border: 1px solid #ddd; border-radius: 5px; flex: 1;">
                        <button onclick="clearPochesPlan()" style="padding: 10px 20px; background: #c5554a; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                            üóëÔ∏è Effacer Plan
                        </button>
                    </div>
                </div>

                <!-- Zone de placement des poches -->
                <div id="pochesplanContainer" style="display: none;">
                    <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h3 style="color: #667eea; margin: 0;">üó∫Ô∏è √âtape 2 : Placer les Poches sur le Plan</h3>
                            <div style="display: flex; gap: 10px;">
                                <button onclick="addPocheMode()" id="addPocheModeBtn" style="padding: 8px 15px; background: #4a7c59; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                                    ‚ûï Mode Ajout
                                </button>
                                <button onclick="cancelPocheMode()" id="cancelPocheModeBtn" style="display: none; padding: 8px 15px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                                    ‚ùå Annuler Mode Ajout
                                </button>
                            </div>
                        </div>
                        <p style="color: #000000; margin-bottom: 15px;">Cliquez sur le plan pour placer une poche. Vous pourrez ensuite ajouter des commentaires.</p>

                        <div style="position: relative; border: 2px solid #ddd; border-radius: 8px; overflow: hidden; background: #f8f9fa; max-width: 100%;">
                            <canvas id="pochesplanCanvas" style="display: block; max-width: 100%; cursor: crosshair;"></canvas>
                        </div>
                    </div>

                    <!-- Liste des poches -->
                    <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <h3 style="color: #667eea; margin-top: 0;">üìã Liste des Poches Plac√©es</h3>
                        <div id="pochesList">
                            <p style="text-align: center; color: #999; padding: 20px;">Aucune poche plac√©e</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

<div id="detail-t128" class="page">
            <div class="summary-container">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">FOURNIR LA LISTE DES TRAVAUX NON √âLECTRIQUE FAIT PENDANT L'ARR√äT √âLECTRIQUE AU SERVICE INCENDIE</h2>
                </div>
                <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <p style="color: #000000; font-size: 1.1em;">Liste des travaux non √©lectriques effectu√©s pendant l'arr√™t √©lectrique pour le service incendie.</p>
                </div>
            </div>
        </div>

<div id="detail-t131" class="page">
            <div class="summary-container">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">REVUE S√âCURIT√â</h2>
                </div>
                <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <p style="color: #000000; font-size: 1.1em;">Revue compl√®te des aspects s√©curit√© de l'arr√™t annuel.</p>
                </div>
            </div>
        </div>

<div id="detail-t132" class="page">
            <div class="summary-container">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">INFORMER LES BESOINS DE PERMIS DE FEU</h2>
                </div>
                <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <p style="color: #000000; font-size: 1.1em;">Information et gestion des besoins en permis de feu pour les travaux √† chaud.</p>
                </div>
            </div>
        </div>

<div id="detail-t136" class="page">
            <div class="summary-container">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">R√âVISION FINALE DU PROTOCOLE D'ARR√äT ET D√âMARRAGE</h2>
                </div>
                <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <p style="color: #000000; font-size: 1.1em;">R√©vision finale et validation du protocole d'arr√™t et de d√©marrage.</p>
                </div>
            </div>
        </div>

<div id="detail-t139" class="page">
            <div class="summary-container">
                <div style="display: flex; align-items: center; margin-bottom: 20px;">
                    <button onclick="switchPage('summary')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">‚Üê Retour</button>
                    <h2 style="margin: 0; color: #333;">BRANCHEMENT DES ROULOTTES</h2>
                </div>
                <div style="background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <p style="color: #000000; font-size: 1.1em;">Coordination et r√©alisation des branchements des roulottes (√©lectricit√©, eau, etc.).</p>
                </div>
            </div>
        </div>

<div id="detail-t4-t9-combined" class="page">
    <div class="summary-container" style="max-width: 95%;">
        <!-- Bouton Retour en haut -->
        <div style="display: flex; align-items: center; margin-bottom: 20px;">
            <button onclick="switchPage('summary')"
                    style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; margin-right: 15px;">
                ‚Üê Retour
            </button>
            <h2 style="margin: 0; color: #333;">PROJETS ET MAINTENANCES CAPITALISABLES</h2>
        </div>

        <!-- PREMIER TABLEAU: PROJETS / TRAVAUX MAJEURS -->
        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 30px;">
            <h3 style="margin-top: 0; margin-bottom: 15px; color: #333;">AVOIR LA LISTE DES PROJETS / TRAVAUX MAJEURS ENTRETIEN QUI SERONT FAIT √Ä L'ARR√äT</h3>

            <!-- Boutons d'action pour projets -->
            <div style="margin-bottom: 20px; display: flex; gap: 10px;">
                <button onclick="addProjetRow()"
                        style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                    ‚ûï Ajouter un Projet
                </button>
                <button onclick="document.getElementById('uploadProjetsExcel').click()"
                        style="padding: 10px 20px; background: #217346; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                    üì§ Importer Excel/CSV
                </button>
                <input type="file" id="uploadProjetsExcel" accept=".xlsx,.xls,.csv" style="display: none;" onchange="handleProjetsUpload(event)">
            </div>

            <!-- Tableau des projets -->
            <div style="overflow-x: auto; max-height: 500px; overflow-y: auto;">
                <table style="width: 100%; border-collapse: collapse; font-size: 0.9em;">
                    <thead style="position: sticky; top: 0; background: white; z-index: 10;">
                        <tr style="background: #f8f9fa; border-bottom: 2px solid #dee2e6;">
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; white-space: nowrap;">Ordre</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; white-space: nowrap;">Avis</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 150px;">Poste Technique</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 200px;">Description</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; white-space: nowrap;">D√©cision</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; white-space: nowrap;">Date</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 300px; width: 25%;">Commentaire</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; min-width: 200px; width: 15%;">Documents</th>
                        </tr>
                    </thead>
                    <tbody id="projetsTableBody">
                        <tr>
                            <td colspan="8" style="padding: 30px; text-align: center; color: #666;">
                                Aucun projet ajout√©. Cliquez sur "Ajouter un Projet" pour commencer.
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- DEUXIEME TABLEAU: MAINTENANCES CAPITALISABLES -->
        <div style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            <h3 style="margin-top: 0; margin-bottom: 15px; color: #333;">OBTENIR LA LISTE DES MAINTENANCES CAPITALISABLES</h3>

            <!-- Boutons d'action pour maintenances -->
            <div style="margin-bottom: 20px; display: flex; gap: 10px;">
                <button onclick="addMaintenanceCapitalisableRow()"
                        style="padding: 10px 20px; background: #4a7c59; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                    ‚ûï Ajouter une Maintenance
                </button>
                <button onclick="document.getElementById('uploadMaintenancesCapExcel').click()"
                        style="padding: 10px 20px; background: #217346; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                    üì§ Importer Excel/CSV
                </button>
                <input type="file" id="uploadMaintenancesCapExcel" accept=".xlsx,.xls,.csv" style="display: none;" onchange="handleMaintenancesCapitalisablesUpload(event)">
            </div>

            <!-- Tableau des maintenances -->
            <div style="overflow-x: auto; max-height: 500px; overflow-y: auto;">
                <table style="width: 100%; border-collapse: collapse; font-size: 0.9em;">
                    <thead style="position: sticky; top: 0; background: white; z-index: 10;">
                        <tr style="background: #f8f9fa; border-bottom: 2px solid #dee2e6;">
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; white-space: nowrap;">Ordre</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; white-space: nowrap;">Avis</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 150px;">Poste Technique</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 200px;">Description</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; white-space: nowrap;">D√©cision</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; white-space: nowrap;">Date</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: left; min-width: 300px;">Commentaire</th>
                            <th style="padding: 12px; border: 1px solid #dee2e6; text-align: center; min-width: 180px;">Documents/Photos</th>
                        </tr>
                    </thead>
                    <tbody id="maintenancesCapitalisablesTableBody">
                        <tr>
                            <td colspan="8" style="padding: 30px; text-align: center; color: #666;">
                                Aucune maintenance ajout√©e. Cliquez sur "Ajouter une Maintenance" pour commencer.
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

        <!-- PAGE CONTACTS -->
<div id="contacts" class="page">
    <div class="card">
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 25px;">
            <h2 style="margin: 0; color: #333;">üìû Contacts</h2>
            <button onclick="window.switchToPage('dashboard')" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                ‚Üê Retour au Dashboard
            </button>
        </div>

        <!-- Les deux tableaux c√¥te √† c√¥te -->
        <div style="display: grid; grid-template-columns: 3fr 1fr; gap: 20px;">

            <!-- TABLEAU 1 : Contacts Principaux -->
            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="color: #667eea; margin: 0;">üë• Contacts Principaux</h3>
                    <button onclick="addContact()" style="padding: 8px 16px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                        ‚ûï Ajouter un contact
                    </button>
                </div>

                <!-- Barre de recherche -->
                <div style="margin-bottom: 15px;">
                    <input type="text" id="contactsSearchInput" placeholder="üîç Rechercher par Nom, Code ou Entreprise..."
                        oninput="window.filterContactsTable()"
                        style="width: 100%; padding: 10px; border: 2px solid #667eea; border-radius: 8px; font-size: 14px; box-sizing: border-box;">
                </div>

                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: linear-gradient(145deg, #667eea, #764ba2); color: white;">
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; min-width: 150px;">Nom</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; min-width: 200px;">Adresse</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; min-width: 100px;">Code</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; min-width: 150px;">Entreprise</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left; min-width: 120px;">Cas</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: center; width: 80px;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="contactsTableBody">
                            <tr><td colspan="6" style="padding: 20px; text-align: center; color: #999;">Aucun contact. Cliquez sur "Ajouter un contact".</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- TABLEAU 2 : Code Externe -->
            <div style="background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h3 style="color: #667eea; margin: 0;">üè¢ Code Externe</h3>
                    <button onclick="addCodeExterne()" style="padding: 8px 16px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;">
                        ‚ûï Ajouter
                    </button>
                </div>

                <!-- Barre de recherche -->
                <div style="margin-bottom: 15px;">
                    <input type="text" id="codesExternesSearchInput" placeholder="üîç Rechercher par Code ou Nom..."
                        oninput="window.filterCodesExternesTable()"
                        style="width: 100%; padding: 10px; border: 2px solid #28a745; border-radius: 8px; font-size: 14px; box-sizing: border-box;">
                </div>

                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: linear-gradient(145deg, #28a745, #20c997); color: white;">
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left;">Code Externe</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: left;">Nom</th>
                                <th style="padding: 10px; border: 1px solid #dee2e6; text-align: center; width: 60px;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="codeExterneTableBody">
                            <tr><td colspan="3" style="padding: 20px; text-align: center; color: #999;">Aucun code. Cliquez sur "Ajouter".</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
</div>

        <!-- FIN DES PAGES SUPPL√âMENTAIRES -->

    </body>
</html>
